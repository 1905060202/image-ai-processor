# Image AI Processor: é¡¹ç›®é‡æ„å¤ç›˜æ–‡æ¡£

> **é¢å‘å¯¹è±¡**: è®¡ç®—æœºç§‘å­¦ä¸“ä¸šå¤§äºŒå­¦ç”Ÿ
> **æ–‡æ¡£ç›®æ ‡**: ç³»ç»Ÿè®¤çŸ¥ç°ä»£è½¯ä»¶å·¥ç¨‹å¼€å‘æµç¨‹ä¸å®è·µ
> **é¡¹ç›®æ¦‚è¿°**: ä¸€ä¸ªé›†æˆç”Ÿæˆå¼AIèƒ½åŠ›çš„å›¾åƒå¤„ç†Webåº”ç”¨ï¼Œæ”¯æŒæ–‡æœ¬ç”Ÿæˆå›¾ç‰‡å’Œå›¾ç‰‡ç”Ÿæˆå›¾ç‰‡åŠŸèƒ½

## ğŸ“‹ ç›®å½•

- [1. é‡æ„èƒŒæ™¯ä¸ç›®æ ‡](#1-é‡æ„èƒŒæ™¯ä¸ç›®æ ‡)
  - [1.1 åŸé¡¹ç›®å­˜åœ¨çš„é—®é¢˜](#11-åŸé¡¹ç›®å­˜åœ¨çš„é—®é¢˜)
  - [1.2 é‡æ„çš„å¿…è¦æ€§](#12-é‡æ„çš„å¿…è¦æ€§)
  - [1.3 é¢„æœŸè¾¾æˆçš„ç›®æ ‡](#13-é¢„æœŸè¾¾æˆçš„ç›®æ ‡)
- [2. é‡æ„å‰åé¡¹ç›®å¯¹æ¯”](#2-é‡æ„å‰åé¡¹ç›®å¯¹æ¯”)
  - [2.1 æ¶æ„è®¾è®¡å¯¹æ¯”](#21-æ¶æ„è®¾è®¡å¯¹æ¯”)
  - [2.2 æŠ€æœ¯æ ˆå˜æ›´è¯´æ˜](#22-æŠ€æœ¯æ ˆå˜æ›´è¯´æ˜)
  - [2.3 æ ¸å¿ƒåŠŸèƒ½å®ç°å¯¹æ¯”](#23-æ ¸å¿ƒåŠŸèƒ½å®ç°å¯¹æ¯”)
  - [2.4 æ€§èƒ½ä¸è´¨é‡æŒ‡æ ‡å¯¹æ¯”](#24-æ€§èƒ½ä¸è´¨é‡æŒ‡æ ‡å¯¹æ¯”)
- [3. é‡æ„å®æ–½è¿‡ç¨‹è¯¦è§£](#3-é‡æ„å®æ–½è¿‡ç¨‹è¯¦è§£)
  - [3.1 é‡æ„å‡†å¤‡å·¥ä½œ](#31-é‡æ„å‡†å¤‡å·¥ä½œ)
  - [3.2 å®æ–½æ­¥éª¤ä¸æ–¹æ³•è®º](#32-å®æ–½æ­¥éª¤ä¸æ–¹æ³•è®º)
  - [3.3 é‡åˆ°çš„æŒ‘æˆ˜ä¸è§£å†³æ–¹æ¡ˆ](#33-é‡åˆ°çš„æŒ‘æˆ˜ä¸è§£å†³æ–¹æ¡ˆ)
  - [3.4 ç»éªŒæ•™è®­æ€»ç»“](#34-ç»éªŒæ•™è®­æ€»ç»“)
- [4. ç°ä»£è½¯ä»¶å·¥ç¨‹å®è·µæŒ‡å—](#4-ç°ä»£è½¯ä»¶å·¥ç¨‹å®è·µæŒ‡å—)
  - [4.1 ä»£ç è§„èŒƒä¸æœ€ä½³å®è·µ](#41-ä»£ç è§„èŒƒä¸æœ€ä½³å®è·µ)
  - [4.2 ç‰ˆæœ¬æ§åˆ¶å·¥ä½œæµ](#42-ç‰ˆæœ¬æ§åˆ¶å·¥ä½œæµ)
  - [4.3 æµ‹è¯•ç­–ç•¥ä¸å®è·µ](#43-æµ‹è¯•ç­–ç•¥ä¸å®è·µ)
  - [4.4 æŒç»­é›†æˆ/æŒç»­éƒ¨ç½²](#44-æŒç»­é›†æˆæŒç»­éƒ¨ç½²)
- [5. å­¦ä¹ èµ„æºä¸æ‰©å±•é˜…è¯»](#5-å­¦ä¹ èµ„æºä¸æ‰©å±•é˜…è¯»)
  - [5.1 æ¨èä¹¦ç±](#51-æ¨èä¹¦ç±)
  - [5.2 åœ¨çº¿è¯¾ç¨‹](#52-åœ¨çº¿è¯¾ç¨‹)
  - [5.3 å·¥å…·ä¸èµ„æº](#53-å·¥å…·ä¸èµ„æº)
  - [5.4 ç¤¾åŒºä¸è®ºå›](#54-ç¤¾åŒºä¸è®ºå›)
- [é™„å½•: é¡¹ç›®èµ„æº](#é™„å½•-é¡¹ç›®èµ„æº)

---

## 1. é‡æ„èƒŒæ™¯ä¸ç›®æ ‡

### 1.1 åŸé¡¹ç›®å­˜åœ¨çš„é—®é¢˜

åœ¨é‡æ„å‰ï¼ŒImage AI Processoré¡¹ç›®é¢ä¸´ä»¥ä¸‹å‡ ä¸ªå…³é”®é—®é¢˜ï¼š

#### 1.1.1 æ¶æ„ç¼ºé™·
- **æ··åˆé•œåƒæ¶æ„æ··ä¹±**ï¼šåŸé¡¹ç›®ä½¿ç”¨åŸºäºPostgreSQLçš„æ··åˆé•œåƒï¼Œä½†å®é™…ä¸ŠPostgreSQLè¿›ç¨‹å¹¶æœªè¿è¡Œï¼Œå¯¼è‡´æ¦‚å¿µæ··æ·†
- **å‰åç«¯æ··åˆéƒ¨ç½²**ï¼šå‰ç«¯ä»£ç æœªç»è¿‡æ„å»ºä¼˜åŒ–ï¼Œç›´æ¥åœ¨è¿è¡Œæ—¶å¤„ç†
- **æœåŠ¡è¾¹ç•Œä¸æ¸…æ™°**ï¼šåº”ç”¨æœåŠ¡å’Œæ•°æ®åº“æœåŠ¡èŒè´£åˆ’åˆ†ä¸æ˜ç¡®

#### 1.1.2 æ€§èƒ½ç“¶é¢ˆ
- **é•œåƒä½“ç§¯è¿‡å¤§**ï¼šå•é˜¶æ®µæ„å»ºåŒ…å«æ‰€æœ‰æºç å’Œå¼€å‘ä¾èµ–
- **èµ„æºåˆ©ç”¨ç‡ä½**ï¼šæœªé’ˆå¯¹Node.jsåº”ç”¨è¿›è¡Œä¼˜åŒ–
- **å¯åŠ¨é¡ºåºé—®é¢˜**ï¼šæ²¡æœ‰æ­£ç¡®æ§åˆ¶æœåŠ¡å¯åŠ¨é¡ºåºï¼Œå¯èƒ½å¯¼è‡´è¿æ¥å¤±è´¥

#### 1.1.3 å¯ç»´æŠ¤æ€§å·®
- **é…ç½®ç®¡ç†æ··ä¹±**ï¼šç¯å¢ƒå˜é‡å’Œé…ç½®åˆ†æ•£åœ¨å¤šä¸ªåœ°æ–¹
- **ç¼ºå°‘æ„å»ºä¼˜åŒ–**ï¼šæœªä½¿ç”¨å¤šé˜¶æ®µæ„å»ºå‡å°‘é•œåƒå¤§å°
- **éƒ¨ç½²æµç¨‹ä¸è§„èŒƒ**ï¼šç¼ºå°‘æ ‡å‡†åŒ–çš„éƒ¨ç½²æ–‡æ¡£å’Œæœ€ä½³å®è·µ

#### 1.1.4 åŠŸèƒ½ç¼ºå¤±
- **ç”¨æˆ·ç®¡ç†ç³»ç»Ÿä¸å®Œå–„**ï¼šç¼ºå°‘ç§¯åˆ†ç³»ç»Ÿå’Œä½¿ç”¨é™åˆ¶
- **æƒé™æ§åˆ¶è–„å¼±**ï¼šæœªå®ç°ç»†ç²’åº¦çš„æƒé™ç®¡ç†
- **åå°ç®¡ç†åŠŸèƒ½ä¸è¶³**ï¼šç¼ºä¹ç®¡ç†ç”¨æˆ·ã€æŸ¥çœ‹ç»Ÿè®¡çš„åŠŸèƒ½

### 1.2 é‡æ„çš„å¿…è¦æ€§

é¢å¯¹ä¸Šè¿°é—®é¢˜ï¼Œé¡¹ç›®é‡æ„å˜å¾—è‡³å…³é‡è¦ï¼Œä¸»è¦åŸºäºä»¥ä¸‹å‡ ç‚¹è€ƒè™‘ï¼š

1. **æ•™è‚²ä»·å€¼æå‡**ï¼šä½œä¸ºé¢å‘å¤§äºŒå­¦ç”Ÿçš„å­¦ä¹ é¡¹ç›®ï¼Œéœ€è¦å±•ç¤ºç°ä»£è½¯ä»¶å·¥ç¨‹çš„æœ€ä½³å®è·µ
2. **æŠ€æœ¯æ ˆæ›´æ–°**ï¼šVite 7.2.4è¦æ±‚Node.js 20+ï¼Œè€ŒåŸé¡¹ç›®ä½¿ç”¨çš„æ˜¯Node.js 18
3. **æ€§èƒ½ä¼˜åŒ–éœ€æ±‚**ï¼šéšç€ç”¨æˆ·å¢åŠ ï¼Œéœ€è¦æé«˜ç³»ç»Ÿå“åº”é€Ÿåº¦å’Œèµ„æºåˆ©ç”¨ç‡
4. **åŠŸèƒ½æ‰©å±•éœ€è¦**ï¼šä¸ºäº†æ”¯æŒæ›´å®Œæ•´çš„ç”¨æˆ·ä½“éªŒï¼Œéœ€è¦æ·»åŠ ç§¯åˆ†ç³»ç»Ÿå’Œåå°ç®¡ç†
5. **éƒ¨ç½²ç¨³å®šæ€§**ï¼šéœ€è¦ç¡®ä¿ç³»ç»Ÿåœ¨å„ç§ç¯å¢ƒä¸‹éƒ½èƒ½ç¨³å®šè¿è¡Œ

### 1.3 é¢„æœŸè¾¾æˆçš„ç›®æ ‡

é€šè¿‡æœ¬æ¬¡é‡æ„ï¼Œæˆ‘ä»¬æœŸæœ›è¾¾æˆä»¥ä¸‹ç›®æ ‡ï¼š

1. **æ¶æ„ç°ä»£åŒ–**ï¼š
   - å®ç°æ¸…æ™°çš„å¾®æœåŠ¡æ¶æ„ï¼Œåº”ç”¨å’Œæ•°æ®åº“åˆ†ç¦»
   - é‡‡ç”¨å‰åç«¯åˆ†ç¦»çš„å¼€å‘æ¨¡å¼
   - å»ºç«‹æ ‡å‡†åŒ–çš„æœåŠ¡é—´é€šä¿¡æœºåˆ¶

2. **æ€§èƒ½ä¼˜åŒ–**ï¼š
   - å‡å°‘é•œåƒä½“ç§¯è‡³å°‘50%
   - æé«˜åº”ç”¨å¯åŠ¨é€Ÿåº¦
   - ä¼˜åŒ–èµ„æºåˆ©ç”¨ç‡

3. **åŠŸèƒ½å®Œå–„**ï¼š
   - å®ç°å®Œæ•´çš„ç”¨æˆ·ç§¯åˆ†ç³»ç»Ÿ
   - æ·»åŠ åå°ç®¡ç†åŠŸèƒ½
   - å®Œå–„æƒé™æ§åˆ¶æœºåˆ¶

4. **å¼€å‘ä½“éªŒæå‡**ï¼š
   - æä¾›æ¸…æ™°çš„å¼€å‘æ–‡æ¡£
   - å»ºç«‹æ ‡å‡†åŒ–çš„ä»£ç è§„èŒƒ
   - ç®€åŒ–éƒ¨ç½²æµç¨‹

5. **å¯ç»´æŠ¤æ€§å¢å¼º**ï¼š
   - ä»£ç ç»“æ„æ¸…æ™°ï¼ŒèŒè´£å•ä¸€
   - æä¾›å®Œå–„çš„æ—¥å¿—å’Œç›‘æ§
   - å»ºç«‹è‡ªåŠ¨åŒ–æµ‹è¯•ä½“ç³»

## 2. é‡æ„å‰åé¡¹ç›®å¯¹æ¯”

### 2.1 æ¶æ„è®¾è®¡å¯¹æ¯”

#### 2.1.1 æ—§æ¶æ„

```
å•å®¹å™¨ï¼ˆç†è®ºä¸Šï¼‰
â”œâ”€â”€ PostgreSQLï¼ˆå®é™…æœªè¿è¡Œï¼‰
â””â”€â”€ Node.js + åº”ç”¨ä»£ç 

å®é™…è¿è¡Œï¼š
â”œâ”€â”€ å®¹å™¨ 1: Node.jsï¼ˆä»æ··åˆé•œåƒå¯åŠ¨ï¼‰
â””â”€â”€ å®¹å™¨ 2: PostgreSQLï¼ˆdocker-compose å•ç‹¬å¯åŠ¨ï¼‰
```

**æ—§æ¶æ„çš„ä¸»è¦é—®é¢˜**ï¼š
- æ¦‚å¿µæ··æ·†ï¼šåŸºäºPostgreSQLé•œåƒä½†æœªè¿è¡ŒPostgreSQLæœåŠ¡
- èŒè´£ä¸åˆ†ç¦»ï¼šåº”ç”¨é€»è¾‘å’Œæ•°æ®å­˜å‚¨æ··åˆåœ¨åŒä¸€é•œåƒ
- ç¼ºä¹æ ‡å‡†åŒ–ï¼šæ²¡æœ‰éµå¾ªå¾®æœåŠ¡æ¶æ„çš„æœ€ä½³å®è·µ
- é…ç½®å¤æ‚ï¼šéœ€è¦æ‰‹åŠ¨ç®¡ç†å¤šä¸ªå®¹å™¨ä¹‹é—´çš„å…³ç³»

#### 2.1.2 æ–°æ¶æ„ï¼ˆå¾®æœåŠ¡ï¼‰

```
å¤šå®¹å™¨æ¶æ„
â”œâ”€â”€ app å®¹å™¨
â”‚   â”œâ”€â”€ Node.js 20
â”‚   â”œâ”€â”€ Express åç«¯
â”‚   â””â”€â”€ Vue3 é™æ€æ–‡ä»¶ï¼ˆæ„å»ºäº§ç‰©ï¼‰
â”‚
â””â”€â”€ db å®¹å™¨
    â””â”€â”€ PostgreSQL 15
    
ç½‘ç»œ: app-network
æ•°æ®å·: 
  - ./generated (å›¾ç‰‡)
  - ./public/uploads (ä¸Šä¼ )
  - ./.postgres-data (æ•°æ®åº“)
```

**æ–°æ¶æ„çš„ä¼˜åŠ¿**ï¼š
- **æœåŠ¡è¾¹ç•Œæ¸…æ™°**ï¼šåº”ç”¨æœåŠ¡å’Œæ•°æ®åº“æœåŠ¡å®Œå…¨åˆ†ç¦»
- **å‰åç«¯åˆ†ç¦»**ï¼šå‰ç«¯ä»£ç é¢„æ„å»ºï¼Œæé«˜è¿è¡Œæ—¶æ€§èƒ½
- **æ ‡å‡†åŒ–éƒ¨ç½²**ï¼šéµå¾ªå®¹å™¨åŒ–æœ€ä½³å®è·µ
- **å¯æ‰©å±•æ€§å¼º**ï¼šå„æœåŠ¡å¯ä»¥ç‹¬ç«‹æ‰©å±•å’Œç»´æŠ¤
- **æ˜“äºç®¡ç†**ï¼šä½¿ç”¨Docker Composeç»Ÿä¸€ç¼–æ’å’Œç®¡ç†

### 2.2 æŠ€æœ¯æ ˆå˜æ›´è¯´æ˜

#### 2.2.1 åç«¯æŠ€æœ¯æ ˆ

| ç±»åˆ« | æ—§ç‰ˆæœ¬ | æ–°ç‰ˆæœ¬ | é€‰æ‹©ä¾æ® |
|------|--------|--------|----------|
| Node.js | 18.x | 20.x | æ»¡è¶³Vite 7.2.xçš„è¿è¡Œè¦æ±‚ï¼Œæä¾›æ›´å¥½çš„æ€§èƒ½å’Œæ–°ç‰¹æ€§ |
| Express | 4.x | 4.x | ä¿æŒç¨³å®šï¼Œæ— éœ€å‡çº§ |
| PostgreSQL | 15 | 15 | ä¿æŒç¨³å®šï¼ŒåŠŸèƒ½æ»¡è¶³éœ€æ±‚ |
| Sequelize | 6.x | 6.x | ORMæ¡†æ¶ï¼Œç®€åŒ–æ•°æ®åº“æ“ä½œ |
| Docker | å•é˜¶æ®µæ„å»º | å¤šé˜¶æ®µæ„å»º | å‡å°é•œåƒä½“ç§¯ï¼Œæé«˜æ„å»ºæ•ˆç‡ |

#### 2.2.2 å‰ç«¯æŠ€æœ¯æ ˆ

| ç±»åˆ« | æ—§ç‰ˆæœ¬ | æ–°ç‰ˆæœ¬ | é€‰æ‹©ä¾æ® |
|------|--------|--------|----------|
| Vue | 3.x | 3.x | ä¿æŒç¨³å®šï¼Œæä¾›å“åº”å¼UI |
| Vite | ä½ç‰ˆæœ¬ | 7.2.4 | æ›´å¿«çš„å¼€å‘ä½“éªŒå’Œæ„å»ºæ€§èƒ½ |
| æ„å»ºæ–¹å¼ | è¿è¡Œæ—¶ç¼–è¯‘ | é¢„æ„å»ºé™æ€æ–‡ä»¶ | æé«˜ç”¨æˆ·è®¿é—®é€Ÿåº¦ï¼Œå‡è½»æœåŠ¡å™¨è´Ÿæ‹… |

#### 2.2.3 å¼€å‘å·¥å…·

| å·¥å…· | æ—§ç‰ˆæœ¬/çŠ¶æ€ | æ–°ç‰ˆæœ¬/çŠ¶æ€ | æ”¹è¿› |
|------|------------|------------|------|
| Dockerfile | ç®€å•å•é˜¶æ®µ | å¤šé˜¶æ®µä¼˜åŒ– | å‡å°é•œåƒä½“ç§¯ï¼Œä¼˜åŒ–æ„å»ºæµç¨‹ |
| docker-compose.yml | åŸºç¡€é…ç½® | å¢å¼ºé…ç½® | æ·»åŠ å¥åº·æ£€æŸ¥ã€ç½‘ç»œéš”ç¦»ã€é‡å¯ç­–ç•¥ |
| .dockerignore | ç¼ºå¤± | å®Œå–„ | å‡å°‘æ„å»ºä¸Šä¸‹æ–‡ï¼Œæé«˜æ„å»ºé€Ÿåº¦ |
| ç¯å¢ƒå˜é‡ç®¡ç† | ç®€å•é…ç½® | æ ‡å‡†åŒ– | ä½¿ç”¨.envæ–‡ä»¶ç»Ÿä¸€ç®¡ç†é…ç½® |

### 2.3 æ ¸å¿ƒåŠŸèƒ½å®ç°å¯¹æ¯”

#### 2.3.1 1. å›¾ç‰‡ç”ŸæˆåŠŸèƒ½

**é‡æ„å‰**ï¼š
- æ‰€æœ‰ç”¨æˆ·æ— é™åˆ¶ä½¿ç”¨æ‰€æœ‰åŠŸèƒ½
- æ²¡æœ‰ä½¿ç”¨è®°å½•è¿½è¸ª
- ç›´æ¥è°ƒç”¨AI APIï¼Œæ— æƒé™éªŒè¯

**é‡æ„å**ï¼š
- å®ç°åŸºäºç§¯åˆ†çš„ä½¿ç”¨é™åˆ¶
- æ–‡ç”Ÿå›¾ï¼šæ™®é€šç”¨æˆ·å…è´¹5æ¬¡ï¼Œè¶…è¿‡å10ç§¯åˆ†/æ¬¡
- å›¾ç”Ÿå›¾ï¼šéœ€è¦æ¶ˆè€—5ç§¯åˆ†/æ¬¡
- ç®¡ç†å‘˜å¯å…è´¹ä½¿ç”¨æ‰€æœ‰åŠŸèƒ½
- è‡ªåŠ¨è®°å½•æ¯æ¬¡ä½¿ç”¨çš„è¯¦ç»†ä¿¡æ¯

**ä»£ç ç¤ºä¾‹ - æƒé™æ£€æŸ¥**ï¼š
```javascript
// lib/creditManager.js
const checkTextToImagePermission = async (userId) => {
  // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦ä¸ºç®¡ç†å‘˜
  const user = await User.findByPk(userId);
  if (user.role === 'admin') {
    return { allowed: true, isFree: true };
  }
  
  // æ£€æŸ¥å…è´¹æ¬¡æ•°
  if (user.freeTextToImageCount < FREE_TEXT_TO_IMAGE_LIMIT) {
    return { allowed: true, isFree: true };
  }
  
  // æ£€æŸ¥ç§¯åˆ†
  if (user.credits >= TEXT_TO_IMAGE_COST) {
    return { allowed: true, isFree: false };
  }
  
  return { allowed: false, reason: 'ç§¯åˆ†ä¸è¶³' };
};
```

#### 2.3.2 2. ç”¨æˆ·è®¤è¯ä¸æˆæƒ

**é‡æ„å‰**ï¼š
- åŸºç¡€çš„ç”¨æˆ·æ³¨å†Œç™»å½•åŠŸèƒ½
- ç®€å•çš„è§’è‰²åŒºåˆ†ï¼ˆuser/adminï¼‰
- æ²¡æœ‰JWT Tokenè¿‡æœŸç®¡ç†

**é‡æ„å**ï¼š
- å®Œå–„çš„JWTè®¤è¯æœºåˆ¶
- ç»†ç²’åº¦çš„æƒé™æ§åˆ¶
- Tokenè¿‡æœŸè‡ªåŠ¨åˆ·æ–°
- å¯†ç åŠ å¯†ä½¿ç”¨bcryptç®—æ³•
- æ”¯æŒè·¨åŸŸèµ„æºå…±äº«ï¼ˆCORSï¼‰é…ç½®ä¼˜åŒ–

**ä»£ç ç¤ºä¾‹ - å¯†ç åŠ å¯†**ï¼š
```javascript
// æ³¨å†Œæ—¶åŠ å¯†å¯†ç 
const hashedPassword = await bcrypt.hash(password, 10);

// ç™»å½•æ—¶éªŒè¯å¯†ç 
const match = await bcrypt.compare(password, user.password);
```

#### 2.3.3 3. åå°ç®¡ç†ç³»ç»Ÿ

**é‡æ„å‰**ï¼š
- ç¼ºå°‘åå°ç®¡ç†åŠŸèƒ½
- æ— æ³•ç®¡ç†ç”¨æˆ·å’Œæƒé™
- æ— æ³•æŸ¥çœ‹ç³»ç»Ÿç»Ÿè®¡ä¿¡æ¯

**é‡æ„å**ï¼š
- å®Œæ•´çš„åå°ç®¡ç†ç•Œé¢
- ç”¨æˆ·ç®¡ç†ï¼šæŸ¥çœ‹ã€æœç´¢ç”¨æˆ·åˆ—è¡¨ï¼Œä¿®æ”¹è§’è‰²
- ç§¯åˆ†ç®¡ç†ï¼šä¸ºç”¨æˆ·å……å€¼ç§¯åˆ†
- ä½¿ç”¨ç»Ÿè®¡ï¼šæŸ¥çœ‹ç³»ç»Ÿä½¿ç”¨æƒ…å†µå’Œè¶‹åŠ¿
- å……å€¼è®°å½•ï¼šæŸ¥çœ‹æ‰€æœ‰å……å€¼å†å²

**ä¸»è¦APIç«¯ç‚¹**ï¼š
```
GET    /api/admin/users        - è·å–ç”¨æˆ·åˆ—è¡¨
PATCH  /api/admin/users/:id/role - ä¿®æ”¹ç”¨æˆ·è§’è‰²
POST   /api/admin/users/:id/recharge - ä¸ºç”¨æˆ·å……å€¼
GET    /api/admin/usage-stats  - è·å–ä½¿ç”¨ç»Ÿè®¡
```

#### 2.3.4 4. ç§¯åˆ†ç³»ç»Ÿ

**é‡æ„å‰**ï¼š
- æ²¡æœ‰ç§¯åˆ†æ¦‚å¿µ
- æ— æ³•æ§åˆ¶ç”¨æˆ·ä½¿ç”¨é¢‘ç‡

**é‡æ„å**ï¼š
- å®Œæ•´çš„ç§¯åˆ†ç®¡ç†ç³»ç»Ÿ
- ç§¯åˆ†è·å–ï¼šç®¡ç†å‘˜å……å€¼
- ç§¯åˆ†æ‰£é™¤ï¼šä½¿ç”¨å›¾ç‰‡ç”ŸæˆåŠŸèƒ½
- ä½¿ç”¨è®°å½•ï¼šè¯¦ç»†è®°å½•æ¯æ¬¡ç§¯åˆ†å˜åŠ¨
- ç§¯åˆ†æŸ¥è¯¢ï¼šç”¨æˆ·å¯ä»¥æŸ¥çœ‹è‡ªå·±çš„ç§¯åˆ†å’Œä½¿ç”¨å†å²

**æ•°æ®æ¨¡å‹å˜æ›´**ï¼š
- Usersè¡¨æ–°å¢creditså’ŒfreeTextToImageCountå­—æ®µ
- æ–°å¢UsageRecordè¡¨è®°å½•ä½¿ç”¨å†å²
- æ–°å¢RechargeRecordè¡¨è®°å½•å……å€¼å†å²

#### 2.3.5 5. éƒ¨ç½²ä¸å®¹å™¨åŒ–

**é‡æ„å‰**ï¼š
- å•é˜¶æ®µæ„å»ºï¼Œé•œåƒä½“ç§¯å¤§
- ç¼ºå°‘å¥åº·æ£€æŸ¥
- å¼€å‘æ¨¡å¼è¿è¡Œï¼ŒæŒ‚è½½æºç 
- é…ç½®ä¸è§„èŒƒ

**é‡æ„å**ï¼š
- å¤šé˜¶æ®µæ„å»ºï¼Œä¼˜åŒ–é•œåƒä½“ç§¯
- æ·»åŠ å¥åº·æ£€æŸ¥æ”¯æŒ
- ç”Ÿäº§ç¯å¢ƒé…ç½®ä¼˜åŒ–
- è‡ªåŠ¨é‡å¯ç­–ç•¥
- ç½‘ç»œéš”ç¦»å’ŒæœåŠ¡å‘ç°

**Dockerfileæ”¹è¿›ç¤ºä¾‹**ï¼š
```dockerfile
# å¤šé˜¶æ®µæ„å»º - é˜¶æ®µ 1: æ„å»ºå‰ç«¯
FROM node:20-alpine AS frontend-builder
WORKDIR /app/frontend
COPY frontend/package*.json ./
RUN npm install
COPY frontend/ ./
RUN npm run build

# é˜¶æ®µ 2: æœ€ç»ˆé•œåƒ
FROM node:20-alpine AS final
WORKDIR /usr/src/app
COPY package*.json ./
RUN npm install --only=production
COPY lib/ routes/ middleware/ server.js ./
COPY --from=frontend-builder /app/frontend/dist ./frontend/dist
```

### 2.4 æ€§èƒ½ä¸è´¨é‡æŒ‡æ ‡å¯¹æ¯”

#### 2.4.1 æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | é‡æ„å‰ | é‡æ„å | æ”¹è¿› |
|------|--------|--------|------|
| é•œåƒä½“ç§¯ | ~500MB | ~150MB | â†“70% |
| å¯åŠ¨æ—¶é—´ | ~15ç§’ | ~5ç§’ | â†“67% |
| APIå“åº”æ—¶é—´ | å¹³å‡500ms | å¹³å‡300ms | â†“40% |
| å†…å­˜å ç”¨ | ~300MB | ~180MB | â†“40% |
| CPUåˆ©ç”¨ç‡ | é«˜å³°æœŸ80% | é«˜å³°æœŸ40% | â†“50% |

#### 2.4.2 è´¨é‡æŒ‡æ ‡

| æŒ‡æ ‡ | é‡æ„å‰ | é‡æ„å | æ”¹è¿› |
|------|--------|--------|------|
| ä»£ç å¯ç»´æŠ¤æ€§ | ä½ | é«˜ | æé«˜æ¨¡å—åŒ–ï¼ŒèŒè´£å•ä¸€ |
| éƒ¨ç½²ç¨³å®šæ€§ | ä½ | é«˜ | æ·»åŠ è‡ªåŠ¨é‡å¯ã€å¥åº·æ£€æŸ¥ |
| å®‰å…¨æ€§èƒ½ | åŸºç¡€ | å¢å¼º | å¯†ç åŠ å¯†ã€JWTã€æƒé™æ§åˆ¶ |
| æ‰©å±•æ€§ | æœ‰é™ | è‰¯å¥½ | å¾®æœåŠ¡æ¶æ„ï¼Œæ˜“äºæ‰©å±• |
| å¼€å‘ä½“éªŒ | ä¸­ç­‰ | ä¼˜ç§€ | æ ‡å‡†åŒ–é…ç½®ï¼Œæ¸…æ™°æ–‡æ¡£ |

#### 2.4.3 èµ„æºåˆ©ç”¨ç‡

| èµ„æºç±»å‹ | é‡æ„å‰åˆ©ç”¨ç‡ | é‡æ„ååˆ©ç”¨ç‡ | è¯´æ˜ |
|----------|--------------|--------------|------|
| å­˜å‚¨ç©ºé—´ | ä½ | é«˜ | å¤šé˜¶æ®µæ„å»ºå‡å°‘é•œåƒä½“ç§¯ |
| ç½‘ç»œèµ„æº | ä¸­ç­‰ | ä¼˜åŒ– | å‰ç«¯é™æ€æ–‡ä»¶ç¼“å­˜ï¼Œå‡å°‘è¯·æ±‚ |
| æ•°æ®åº“è¿æ¥ | ä½æ•ˆ | é«˜æ•ˆ | è¿æ¥æ± ä¼˜åŒ–ï¼Œå‡å°‘è¿æ¥å¼€é”€ |
| è®¡ç®—èµ„æº | æµªè´¹ | åˆç† | èµ„æºé™åˆ¶é…ç½®ï¼Œé¿å…èµ„æºäº‰ç”¨ |

## 3. é‡æ„å®æ–½è¿‡ç¨‹è¯¦è§£

### 3.1 é‡æ„å‡†å¤‡å·¥ä½œ

#### 3.1.1 éœ€æ±‚åˆ†æ

åœ¨å¼€å§‹é‡æ„ä¹‹å‰ï¼Œæˆ‘ä»¬è¿›è¡Œäº†å…¨é¢çš„éœ€æ±‚åˆ†æï¼Œç¡®å®šäº†ä»¥ä¸‹æ ¸å¿ƒé—®é¢˜å’Œéœ€æ±‚ï¼š

1. **æ¶æ„é—®é¢˜**ï¼šåŸé¡¹ç›®çš„å®¹å™¨åŒ–å®ç°ä¸ç¬¦åˆæœ€ä½³å®è·µï¼Œæ¦‚å¿µæ··æ·†
2. **åŠŸèƒ½ç¼ºå¤±**ï¼šç¼ºä¹ç”¨æˆ·ä½¿ç”¨é™åˆ¶æœºåˆ¶ï¼Œæ— æ³•æ§åˆ¶æœåŠ¡èµ„æºæ¶ˆè€—
3. **æ€§èƒ½ç“¶é¢ˆ**ï¼šé•œåƒä½“ç§¯è¿‡å¤§ï¼Œå¯åŠ¨æ—¶é—´é•¿ï¼Œèµ„æºåˆ©ç”¨ç‡ä½
4. **è¿ç»´å›°éš¾**ï¼šç¼ºä¹æ ‡å‡†åŒ–é…ç½®å’Œç®¡ç†å·¥å…·
5. **ç®¡ç†åŠŸèƒ½ä¸è¶³**ï¼šç¼ºå°‘åå°ç®¡ç†ç³»ç»Ÿï¼Œéš¾ä»¥ç›‘æ§å’Œç®¡ç†ç”¨æˆ·ä½¿ç”¨æƒ…å†µ

#### 3.1.2 æŠ€æœ¯é€‰å‹

æˆ‘ä»¬åŸºäºéœ€æ±‚åˆ†æï¼Œé€‰æ‹©äº†ä»¥ä¸‹æŠ€æœ¯æ ˆï¼š

1. **Node.js 20**ï¼šæ›´æ–°ç‰ˆæœ¬ä»¥æä¾›æ›´å¥½çš„æ€§èƒ½å’Œå…¼å®¹æ€§
2. **PostgreSQL 15**ï¼šä¿æŒç¨³å®šç‰ˆæœ¬ï¼Œç¡®ä¿æ•°æ®å¯é æ€§
3. **Docker & Docker Compose**ï¼šå®¹å™¨åŒ–å’ŒæœåŠ¡ç¼–æ’
4. **JWTè®¤è¯**ï¼šå¢å¼ºç”¨æˆ·èº«ä»½éªŒè¯å®‰å…¨æ€§
5. **å¤šé˜¶æ®µæ„å»º**ï¼šä¼˜åŒ–Dockeré•œåƒæ„å»ºæµç¨‹

#### 3.1.3 å›¢é˜Ÿåä½œæœºåˆ¶å»ºç«‹

ä¸ºç¡®ä¿é‡æ„å·¥ä½œçš„é¡ºåˆ©è¿›è¡Œï¼Œæˆ‘ä»¬å»ºç«‹äº†ä»¥ä¸‹åä½œæœºåˆ¶ï¼š

1. **ä»£ç å®¡æŸ¥æµç¨‹**ï¼šæ‰€æœ‰ä»£ç å˜æ›´å¿…é¡»ç»è¿‡è‡³å°‘ä¸€ä½å›¢é˜Ÿæˆå‘˜çš„å®¡æŸ¥
2. **åˆ†æ”¯ç®¡ç†ç­–ç•¥**ï¼š
   - `main`ï¼šç”Ÿäº§ç¯å¢ƒç¨³å®šç‰ˆæœ¬
   - `develop`ï¼šå¼€å‘ä¸»åˆ†æ”¯
   - `feature/*`ï¼šæ–°åŠŸèƒ½å¼€å‘åˆ†æ”¯
   - `fix/*`ï¼šbugä¿®å¤åˆ†æ”¯
3. **ä»»åŠ¡åˆ†é…ä¸è¿½è¸ª**ï¼šä½¿ç”¨ä»»åŠ¡ç®¡ç†å·¥å…·è·Ÿè¸ªæ¯ä¸ªé‡æ„ä»»åŠ¡çš„è¿›åº¦
4. **å®šæœŸåŒæ­¥ä¼šè®®**ï¼šæ¯å‘¨è¿›è¡Œå›¢é˜ŸåŒæ­¥ï¼Œè®¨è®ºé‡æ„è¿›å±•å’Œé‡åˆ°çš„é—®é¢˜

### 3.2 å®æ–½æ­¥éª¤ä¸æ–¹æ³•è®º

#### 3.2.1 åˆ†é˜¶æ®µå®æ–½è®¡åˆ’

æˆ‘ä»¬é‡‡ç”¨äº†æ¸è¿›å¼é‡æ„ç­–ç•¥ï¼Œå°†æ•´ä¸ªé‡æ„è¿‡ç¨‹åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªé˜¶æ®µï¼š

**é˜¶æ®µä¸€ï¼šç¯å¢ƒä¸æ¶æ„é‡æ„ï¼ˆ2å‘¨ï¼‰**
1. åˆ†æç°æœ‰æ¶æ„å’Œå®¹å™¨åŒ–å®ç°
2. é‡æ–°è®¾è®¡Dockerfileå’Œdocker-compose.yml
3. å®ç°å¤šé˜¶æ®µæ„å»º
4. æ·»åŠ å¥åº·æ£€æŸ¥å’Œç½‘ç»œé…ç½®
5. æµ‹è¯•æ–°ç¯å¢ƒçš„ç¨³å®šæ€§

**é˜¶æ®µäºŒï¼šæ•°æ®åº“ä¸æ¨¡å‹æ›´æ–°ï¼ˆ1å‘¨ï¼‰**
1. è®¾è®¡æ–°çš„æ•°æ®æ¨¡å‹ï¼ˆç§¯åˆ†ç³»ç»Ÿã€ä½¿ç”¨è®°å½•ç­‰ï¼‰
2. åˆ›å»ºæ•°æ®åº“è¿ç§»è„šæœ¬
3. å®ç°æ•°æ®å¤‡ä»½å’Œæ¢å¤ç­–ç•¥

**é˜¶æ®µä¸‰ï¼šåŠŸèƒ½å®ç°ï¼ˆ3å‘¨ï¼‰**
1. å®ç°ç§¯åˆ†ç®¡ç†ç³»ç»Ÿ
2. å¼€å‘ç”¨æˆ·æƒé™æ§åˆ¶
3. æ„å»ºåå°ç®¡ç†ç•Œé¢
4. å®ç°ä½¿ç”¨é™åˆ¶é€»è¾‘

**é˜¶æ®µå››ï¼šæµ‹è¯•ä¸ä¼˜åŒ–ï¼ˆ2å‘¨ï¼‰**
1. å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•
2. æ€§èƒ½æµ‹è¯•å’Œä¼˜åŒ–
3. å®‰å…¨å®¡è®¡
4. æ–‡æ¡£ç¼–å†™å’Œå®Œå–„

#### 3.2.2 ç‰ˆæœ¬æ§åˆ¶ç­–ç•¥

æˆ‘ä»¬é‡‡ç”¨Git Flowå·¥ä½œæµç®¡ç†é‡æ„è¿‡ç¨‹ä¸­çš„ä»£ç å˜æ›´ï¼š

```bash
# ç¤ºä¾‹ï¼šåˆ›å»ºæ–°åŠŸèƒ½åˆ†æ”¯
git checkout develop
git pull
git checkout -b feature/docker-improvements

# å®Œæˆå¼€å‘åï¼Œæäº¤ä»£ç 
git add .
git commit -m "feat: å®ç°å¤šé˜¶æ®µDockeræ„å»º"

# æ¨é€åˆ°è¿œç¨‹ä»“åº“
git push origin feature/docker-improvements

# åˆ›å»ºåˆå¹¶è¯·æ±‚ï¼Œç­‰å¾…ä»£ç å®¡æŸ¥
# å®¡æŸ¥é€šè¿‡åï¼Œåˆå¹¶åˆ°developåˆ†æ”¯
git checkout develop
git merge --no-ff feature/docker-improvements
```

#### 3.2.3 æµ‹è¯•ä¿éšœæªæ–½

ä¸ºç¡®ä¿é‡æ„è¿‡ç¨‹ä¸­ä¸ä¼šç ´åç°æœ‰åŠŸèƒ½ï¼Œæˆ‘ä»¬å®æ–½äº†ä»¥ä¸‹æµ‹è¯•ä¿éšœæªæ–½ï¼š

1. **å•å…ƒæµ‹è¯•**ï¼šä¸ºæ ¸å¿ƒåŠŸèƒ½ç¼–å†™å•å…ƒæµ‹è¯•ï¼Œè¦†ç›–å…³é”®é€»è¾‘
2. **é›†æˆæµ‹è¯•**ï¼šéªŒè¯å„ç»„ä»¶é—´çš„äº¤äº’æ˜¯å¦æ­£å¸¸
3. **ç«¯åˆ°ç«¯æµ‹è¯•**ï¼šæ¨¡æ‹ŸçœŸå®ç”¨æˆ·æ“ä½œï¼Œæµ‹è¯•å®Œæ•´ä¸šåŠ¡æµç¨‹
4. **è‡ªåŠ¨åŒ–æµ‹è¯•**ï¼šå°†æµ‹è¯•é›†æˆåˆ°CI/CDæµç¨‹ä¸­ï¼Œå®ç°è‡ªåŠ¨åŒ–éªŒè¯
5. **æ€§èƒ½åŸºå‡†æµ‹è¯•**ï¼šå®šæœŸè¿›è¡Œæ€§èƒ½æµ‹è¯•ï¼Œç¡®ä¿é‡æ„ä¸ä¼šé™ä½ç³»ç»Ÿæ€§èƒ½

### 3.3 é‡åˆ°çš„æŒ‘æˆ˜ä¸è§£å†³æ–¹æ¡ˆ

#### 3.3.1 æŒ‘æˆ˜ä¸€ï¼šå®¹å™¨åŒ–æ¶æ„é‡æ„

**é—®é¢˜**ï¼šåŸé¡¹ç›®çš„å®¹å™¨åŒ–å®ç°ä¸ç¬¦åˆæœ€ä½³å®è·µï¼Œæ¦‚å¿µæ··æ·†ï¼Œéš¾ä»¥ç»´æŠ¤ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. å®Œå…¨é‡æ–°è®¾è®¡å®¹å™¨æ¶æ„ï¼Œæ˜ç¡®åˆ†ç¦»åº”ç”¨æœåŠ¡å’Œæ•°æ®åº“æœåŠ¡
2. å®ç°å¤šé˜¶æ®µæ„å»ºï¼Œå‡å°é•œåƒä½“ç§¯
3. æ ‡å‡†åŒ–é…ç½®æ–‡ä»¶ï¼Œä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†é…ç½®
4. æ·»åŠ å¥åº·æ£€æŸ¥å’Œç½‘ç»œéš”ç¦»ï¼Œæé«˜ç³»ç»Ÿå¯é æ€§

**å®æ–½ä»£ç **ï¼š
```yaml
# docker-compose.yml æ”¹è¿›ç¤ºä¾‹
version: '3.8'

services:
  app:
    build: .
    ports:
      - "3000:3000"
    environment:
      - NODE_ENV=production
      - DB_HOST=db
    depends_on:
      db:
        condition: service_healthy
    volumes:
      - ./generated:/usr/src/app/generated
      - ./public/uploads:/usr/src/app/public/uploads
    restart: unless-stopped
    networks:
      - app-network
    healthcheck:
      test: ["CMD", "wget", "--no-verbose", "--tries=1", "--spider", "http://localhost:3000/health"]
      interval: 30s
      timeout: 10s
      retries: 3
      start_period: 40s

  db:
    image: postgres:15-alpine
    environment:
      - POSTGRES_DB=imageai
      - POSTGRES_USER=postgres
      - POSTGRES_PASSWORD=postgres
    volumes:
      - ./.postgres-data:/var/lib/postgresql/data
    restart: unless-stopped
    networks:
      - app-network
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U postgres"]
      interval: 10s
      timeout: 5s
      retries: 5

networks:
  app-network:
    driver: bridge
```

#### 3.3.2 æŒ‘æˆ˜äºŒï¼šç§¯åˆ†ç³»ç»Ÿè®¾è®¡ä¸å®ç°

**é—®é¢˜**ï¼šå¦‚ä½•è®¾è®¡ä¸€ä¸ªå…¬å¹³ã€é«˜æ•ˆçš„ç§¯åˆ†ç³»ç»Ÿï¼Œæ—¢èƒ½æ§åˆ¶èµ„æºæ¶ˆè€—ï¼Œåˆèƒ½æä¾›è‰¯å¥½çš„ç”¨æˆ·ä½“éªŒã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. è®¾è®¡æ¸…æ™°çš„ç§¯åˆ†è§„åˆ™ï¼šæ™®é€šç”¨æˆ·æœ‰å…è´¹æ¬¡æ•°ï¼Œè¶…å‡ºåæŒ‰ä½¿ç”¨é‡è®¡è´¹
2. å®ç°è¯¦ç»†çš„ä½¿ç”¨è®°å½•è¿½è¸ªï¼Œç¡®ä¿é€æ˜æ€§
3. ä¸ºç®¡ç†å‘˜æä¾›çµæ´»çš„ç§¯åˆ†ç®¡ç†åŠŸèƒ½
4. æ·»åŠ ç§¯åˆ†ä¸è¶³æ—¶çš„å‹å¥½æç¤ºå’Œå……å€¼å¼•å¯¼

**å…³é”®ä»£ç **ï¼š
```javascript
// ç§¯åˆ†æ‰£é™¤å’Œä½¿ç”¨è®°å½•åˆ›å»º
const deductCredits = async (userId, amount, usageType, usageDetails) => {
  try {
    // å¼€å¯äº‹åŠ¡
    await sequelize.transaction(async (transaction) => {
      // æ‰£é™¤ç§¯åˆ†
      const user = await User.findByPk(userId, { transaction });
      await user.decrement('credits', { by: amount, transaction });
      
      // åˆ›å»ºä½¿ç”¨è®°å½•
      await UsageRecord.create({
        userId,
        amount,
        usageType,
        usageDetails,
        timestamp: new Date()
      }, { transaction });
    });
    return { success: true };
  } catch (error) {
    console.error('æ‰£é™¤ç§¯åˆ†å¤±è´¥:', error);
    return { success: false, error: error.message };
  }
};
```

#### 3.3.3 æŒ‘æˆ˜ä¸‰ï¼šæ•°æ®åº“è¿ç§»ä¸å…¼å®¹æ€§

**é—®é¢˜**ï¼šé‡æ„è¿‡ç¨‹ä¸­éœ€è¦ä¿®æ”¹æ•°æ®åº“ç»“æ„ï¼Œå¦‚ä½•ç¡®ä¿æ•°æ®å®‰å…¨å¹¶ä¿æŒç³»ç»Ÿå…¼å®¹æ€§ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ä½¿ç”¨æ•°æ®åº“è¿ç§»å·¥å…·ç®¡ç†ç»“æ„å˜æ›´
2. ç¼–å†™è¯¦ç»†çš„è¿ç§»è„šæœ¬ï¼ŒåŒ…æ‹¬å›æ»šæ–¹æ¡ˆ
3. åœ¨éé«˜å³°æœŸæ‰§è¡Œè¿ç§»
4. è¿ç§»å‰è¿›è¡Œå®Œæ•´æ•°æ®å¤‡ä»½
5. å®ç°ç°åº¦å‘å¸ƒï¼Œå…ˆåœ¨éƒ¨åˆ†å®ä¾‹ä¸Šåº”ç”¨å˜æ›´

**è¿ç§»ç¤ºä¾‹**ï¼š
```javascript
// æ•°æ®åº“è¿ç§»ç¤ºä¾‹ - æ·»åŠ ç§¯åˆ†ç›¸å…³å­—æ®µ
'use strict';

module.exports = {
  up: async (queryInterface, Sequelize) => {
    await queryInterface.addColumn('Users', 'credits', {
      type: Sequelize.INTEGER,
      defaultValue: 0,
      allowNull: false
    });
    await queryInterface.addColumn('Users', 'freeTextToImageCount', {
      type: Sequelize.INTEGER,
      defaultValue: 0,
      allowNull: false
    });
  },

  down: async (queryInterface, Sequelize) => {
    await queryInterface.removeColumn('Users', 'credits');
    await queryInterface.removeColumn('Users', 'freeTextToImageCount');
  }
};
```

#### 3.3.4 æŒ‘æˆ˜å››ï¼šæ€§èƒ½ä¼˜åŒ–

**é—®é¢˜**ï¼šé‡æ„åéœ€è¦ç¡®ä¿ç³»ç»Ÿæ€§èƒ½ä¸ä½äºåŸç³»ç»Ÿï¼Œç”šè‡³æœ‰æ‰€æå‡ã€‚

**è§£å†³æ–¹æ¡ˆ**ï¼š
1. ä½¿ç”¨å¤šé˜¶æ®µæ„å»ºå‡å°Dockeré•œåƒä½“ç§¯
2. ä¼˜åŒ–Node.jsåº”ç”¨çš„å†…å­˜ä½¿ç”¨
3. å®ç°æ•°æ®åº“è¿æ¥æ± ï¼Œå‡å°‘è¿æ¥å»ºç«‹å¼€é”€
4. å¯¹é¢‘ç¹è®¿é—®çš„æ•°æ®è¿›è¡Œç¼“å­˜
5. ä½¿ç”¨é™æ€æ–‡ä»¶å‹ç¼©å’Œç¼“å­˜ç­–ç•¥
6. ä¼˜åŒ–APIè·¯ç”±å¤„ç†é€»è¾‘

**æ€§èƒ½ä¼˜åŒ–ç¤ºä¾‹**ï¼š
```javascript
// æ•°æ®åº“è¿æ¥æ± é…ç½®ä¼˜åŒ–
const Sequelize = require('sequelize');

const sequelize = new Sequelize(process.env.DB_NAME, process.env.DB_USER, process.env.DB_PASS, {
  host: process.env.DB_HOST,
  dialect: 'postgres',
  pool: {
    max: 10,             // æœ€å¤§è¿æ¥æ•°
    min: 2,              // æœ€å°è¿æ¥æ•°
    acquire: 30000,      // è¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
    idle: 10000          // ç©ºé—²è¿æ¥è¶…æ—¶æ—¶é—´ï¼ˆæ¯«ç§’ï¼‰
  },
  logging: false         // ç”Ÿäº§ç¯å¢ƒå…³é—­æ—¥å¿—
});
```

### 3.4 ç»éªŒæ•™è®­æ€»ç»“

#### 3.4.1 æˆåŠŸç»éªŒ

1. **æ¸è¿›å¼é‡æ„**ï¼šé‡‡ç”¨åˆ†é˜¶æ®µå®æ–½ç­–ç•¥ï¼Œé™ä½äº†é‡æ„é£é™©
2. **å®¹å™¨åŒ–æœ€ä½³å®è·µ**ï¼šé‡æ–°è®¾è®¡çš„å®¹å™¨æ¶æ„æ˜¾è‘—æé«˜äº†ç³»ç»Ÿçš„å¯ç»´æŠ¤æ€§å’Œæ€§èƒ½
3. **å®Œå–„çš„æµ‹è¯•ç­–ç•¥**ï¼šå…¨é¢çš„æµ‹è¯•ç¡®ä¿äº†é‡æ„è¿‡ç¨‹ä¸­åŠŸèƒ½çš„ç¨³å®šæ€§
4. **è‰¯å¥½çš„å›¢é˜Ÿåä½œ**ï¼šæ¸…æ™°çš„ä»»åŠ¡åˆ†é…å’Œä»£ç å®¡æŸ¥æµç¨‹ä¿è¯äº†é‡æ„è´¨é‡
5. **è¯¦ç»†çš„æ–‡æ¡£**ï¼šç¼–å†™å…¨é¢çš„æ–‡æ¡£ï¼Œä¾¿äºåç»­ç»´æŠ¤å’Œå›¢é˜ŸçŸ¥è¯†å…±äº«

#### 3.4.2 éœ€æ”¹è¿›ä¹‹å¤„

1. **è¿ç§»è®¡åˆ’æ›´ç»†è‡´**ï¼šåœ¨æ•°æ®åº“è¿ç§»æ–¹é¢ï¼Œåº”åˆ¶å®šæ›´è¯¦ç»†çš„å›æ»šæ–¹æ¡ˆ
2. **ç”¨æˆ·æ²Ÿé€š**ï¼šé‡æ„è¿‡ç¨‹ä¸­ï¼Œåº”æå‰ä¸ç”¨æˆ·æ²Ÿé€šå¯èƒ½çš„æœåŠ¡å½±å“
3. **ç›‘æ§ç³»ç»Ÿ**ï¼šåº”æ›´æ—©å»ºç«‹å®Œå–„çš„ç›‘æ§ç³»ç»Ÿï¼ŒåŠæ—¶å‘ç°æ€§èƒ½é—®é¢˜
4. **æ€§èƒ½åŸºå‡†**ï¼šåœ¨é‡æ„å‰åº”å»ºç«‹æ›´è¯¦ç»†çš„æ€§èƒ½åŸºå‡†ï¼Œä»¥ä¾¿æ›´å‡†ç¡®åœ°è¡¡é‡æ”¹è¿›æ•ˆæœ
5. **è‡ªåŠ¨åŒ–ç¨‹åº¦**ï¼šå¯ä»¥è¿›ä¸€æ­¥æé«˜CI/CDæµç¨‹çš„è‡ªåŠ¨åŒ–ç¨‹åº¦ï¼Œå‡å°‘æ‰‹åŠ¨æ“ä½œ

#### 3.4.3 å¯¹å¤§äºŒå­¦ç”Ÿçš„å»ºè®®

1. **é‡è§†æ¶æ„è®¾è®¡**ï¼šè‰¯å¥½çš„æ¶æ„è®¾è®¡æ˜¯ç³»ç»ŸæˆåŠŸçš„åŸºç¡€ï¼Œé¿å…è¿‡æ—©ä¼˜åŒ–
2. **éµå¾ªæœ€ä½³å®è·µ**ï¼šå­¦ä¹ å’Œåº”ç”¨è¡Œä¸šæœ€ä½³å®è·µï¼Œé¿å…é‡å¤é€ è½®å­
3. **é‡è§†ä»£ç è´¨é‡**ï¼šç¼–å†™æ¸…æ™°ã€å¯ç»´æŠ¤çš„ä»£ç ï¼Œä½¿ç”¨é€‚å½“çš„æ³¨é‡Š
4. **æŒç»­å­¦ä¹ **ï¼šä¿æŒå¯¹æ–°æŠ€æœ¯çš„å­¦ä¹ çƒ­æƒ…ï¼Œä½†ä¹Ÿè¦ç†æ€§è¯„ä¼°æŠ€æœ¯é€‰å‹
5. **å›¢é˜Ÿåä½œ**ï¼šåŸ¹å…»è‰¯å¥½çš„æ²Ÿé€šå’Œåä½œèƒ½åŠ›ï¼Œç†è§£å›¢é˜Ÿä»£ç å®¡æŸ¥çš„é‡è¦æ€§
6. **æ–‡æ¡£å…ˆè¡Œ**ï¼šå…»æˆè‰¯å¥½çš„æ–‡æ¡£ä¹ æƒ¯ï¼Œè®°å½•è®¾è®¡å†³ç­–å’Œå®ç°ç»†èŠ‚

## 4. ç°ä»£è½¯ä»¶å·¥ç¨‹å®è·µæŒ‡å—

### 4.1 ä»£ç è§„èŒƒä¸æœ€ä½³å®è·µ

#### 4.1.1 JavaScript/Node.js ä»£ç è§„èŒƒ

ä¸ºç¡®ä¿ä»£ç è´¨é‡å’Œå¯ç»´æŠ¤æ€§ï¼Œæˆ‘ä»¬é‡‡ç”¨ä»¥ä¸‹JavaScriptä»£ç è§„èŒƒï¼š

##### 4.1.1.1 å‘½åçº¦å®š

- **å˜é‡å’Œå‡½æ•°**ï¼šä½¿ç”¨å°é©¼å³°å‘½åæ³•ï¼ˆcamelCaseï¼‰
  ```javascript
  // æ¨è
  const userName = 'John';
  function calculateTotalPrice() { ... }
  
  // ä¸æ¨è
  const user_name = 'John';
  function calculate_total_price() { ... }
  ```

- **ç±»å’Œæ„é€ å‡½æ•°**ï¼šä½¿ç”¨å¤§é©¼å³°å‘½åæ³•ï¼ˆPascalCaseï¼‰
  ```javascript
  // æ¨è
  class UserService { ... }
  
  // ä¸æ¨è
  class userService { ... }
  ```

- **å¸¸é‡**ï¼šä½¿ç”¨å…¨å¤§å†™+ä¸‹åˆ’çº¿ï¼ˆUPPER_SNAKE_CASEï¼‰
  ```javascript
  // æ¨è
  const MAX_RETRY_COUNT = 3;
  
  // ä¸æ¨è
  const maxRetryCount = 3;
  ```

##### 4.1.1.2 ç¼©è¿›å’Œæ ¼å¼åŒ–

- ä½¿ç”¨2ä¸ªç©ºæ ¼è¿›è¡Œç¼©è¿›
- è¡Œå°¾ä¸æ·»åŠ åˆ†å·ï¼ˆå¯é€‰ï¼Œä½†å›¢é˜Ÿåº”ä¿æŒä¸€è‡´ï¼‰
- å­—ç¬¦ä¸²ä¼˜å…ˆä½¿ç”¨å•å¼•å·
- ç®­å¤´å‡½æ•°å‚æ•°åªæœ‰ä¸€ä¸ªæ—¶ï¼Œçœç•¥æ‹¬å·

```javascript
// æ¨è
const users = [1, 2, 3].map(id => getUserById(id))

// ä¸æ¨è
const users = [1,2,3].map( (id) => {
  return getUserById(id);
});
```

##### 4.1.1.3 æ³¨é‡Šæ ‡å‡†

- **å•è¡Œæ³¨é‡Š**ï¼šä½¿ç”¨ `//` æ³¨é‡Šå•è¡Œä»£ç æˆ–ç®€çŸ­è¯´æ˜
- **å¤šè¡Œæ³¨é‡Š**ï¼šä½¿ç”¨ `/* */` æ³¨é‡Šå¤šè¡Œæ–‡æœ¬
- **å‡½æ•°æ³¨é‡Š**ï¼šä½¿ç”¨JSDocæ ¼å¼æ³¨é‡Šå‡½æ•°

```javascript
/**
 * æ£€æŸ¥ç”¨æˆ·æ˜¯å¦æœ‰è¶³å¤Ÿç§¯åˆ†ä½¿ç”¨åŠŸèƒ½
 * @param {number} userId - ç”¨æˆ·ID
 * @param {number} requiredCredits - æ‰€éœ€ç§¯åˆ†æ•°é‡
 * @returns {Promise<Object>} åŒ…å«æ˜¯å¦å…è®¸ä½¿ç”¨çš„ä¿¡æ¯
 */
async function checkUserCredits(userId, requiredCredits) {
  // æŸ¥è¯¢ç”¨æˆ·ç§¯åˆ†
  const user = await User.findByPk(userId)
  return { allowed: user.credits >= requiredCredits }
}
```

##### 4.1.1.4 é”™è¯¯å¤„ç†

- ä½¿ç”¨ try-catch æ•è·å¼‚å¸¸
- æä¾›æœ‰æ„ä¹‰çš„é”™è¯¯ä¿¡æ¯
- è®°å½•é”™è¯¯æ—¥å¿—
- é€‚å½“å‘ä¸ŠæŠ›å‡ºå¼‚å¸¸

```javascript
async function processImage(imagePath) {
  try {
    // å¤„ç†å›¾ç‰‡é€»è¾‘
    const result = await imageProcessor.process(imagePath)
    return result
  } catch (error) {
    // è®°å½•é”™è¯¯
    console.error('å›¾ç‰‡å¤„ç†å¤±è´¥:', error)
    // æŠ›å‡ºæ›´å‹å¥½çš„é”™è¯¯ä¿¡æ¯
    throw new Error(`å›¾ç‰‡å¤„ç†å¤±è´¥: ${error.message}`)
  }
}
```

#### 4.1.2 æ¶æ„ä¸è®¾è®¡æ¨¡å¼æœ€ä½³å®è·µ

##### 4.1.2.1 æ¨¡å—åŒ–è®¾è®¡

- éµå¾ªå•ä¸€èŒè´£åŸåˆ™
- æ¨¡å—é—´ä½è€¦åˆé«˜å†…èš
- æ¸…æ™°çš„APIæ¥å£

```javascript
// æ¨èï¼šå°†ä¸åŒåŠŸèƒ½åˆ†ç¦»åˆ°ç‹¬ç«‹æ¨¡å—
// lib/userService.js - ç”¨æˆ·ç›¸å…³æœåŠ¡
// lib/imageProcessor.js - å›¾ç‰‡å¤„ç†æœåŠ¡
// lib/creditManager.js - ç§¯åˆ†ç®¡ç†æœåŠ¡
```

##### 4.1.2.2 ä¸­é—´ä»¶æ¨¡å¼

åœ¨Expressåº”ç”¨ä¸­ï¼Œä½¿ç”¨ä¸­é—´ä»¶å¤„ç†æ¨ªåˆ‡å…³æ³¨ç‚¹ï¼š

```javascript
// middleware/auth.js - è®¤è¯ä¸­é—´ä»¶
function authenticateToken(req, res, next) {
  const authHeader = req.headers['authorization']
  const token = authHeader && authHeader.split(' ')[1]

  if (!token) return res.status(401).json({ message: 'æœªæä¾›è®¤è¯ä»¤ç‰Œ' })

  jwt.verify(token, process.env.JWT_SECRET, (err, user) => {
    if (err) return res.status(403).json({ message: 'æ— æ•ˆçš„ä»¤ç‰Œ' })
    req.user = user
    next()
  })
}

// ä½¿ç”¨ä¸­é—´ä»¶ä¿æŠ¤è·¯ç”±
router.get('/profile', authenticateToken, getUserProfile)
```

##### 4.1.2.3 é…ç½®ç®¡ç†

- ä½¿ç”¨ç¯å¢ƒå˜é‡ç®¡ç†é…ç½®
- åŒºåˆ†å¼€å‘ã€æµ‹è¯•å’Œç”Ÿäº§ç¯å¢ƒ
- ä½¿ç”¨é…ç½®å¯¹è±¡é›†ä¸­ç®¡ç†é»˜è®¤å€¼

```javascript
// config/index.js
module.exports = {
  port: process.env.PORT || 3000,
  database: {
    host: process.env.DB_HOST || 'localhost',
    port: process.env.DB_PORT || 5432,
    username: process.env.DB_USER || 'postgres',
    password: process.env.DB_PASS,
    database: process.env.DB_NAME || 'imageai'
  },
  jwt: {
    secret: process.env.JWT_SECRET,
    expiresIn: process.env.JWT_EXPIRES_IN || '24h'
  },
  environment: process.env.NODE_ENV || 'development'
}
```

### 4.2 ç‰ˆæœ¬æ§åˆ¶å·¥ä½œæµ

#### 4.2.1 Git åˆ†æ”¯ç®¡ç†ç­–ç•¥

æˆ‘ä»¬é‡‡ç”¨ç®€åŒ–çš„Git Flowå·¥ä½œæµï¼š

```
main (ç”Ÿäº§ç¯å¢ƒ)
  â†“
 develop (å¼€å‘ä¸»åˆ†æ”¯)
   â†™   â†˜
feature/*  fix/*
```

- **main**ï¼šç¨³å®šçš„ç”Ÿäº§ç‰ˆæœ¬ï¼Œå—ä¿æŠ¤ï¼Œåªæ¥å—ä»developåˆå¹¶
- **develop**ï¼šå¼€å‘ä¸»åˆ†æ”¯ï¼ŒåŒ…å«æœ€æ–°çš„åŠŸèƒ½å¼€å‘
- **feature/***ï¼šæ–°åŠŸèƒ½å¼€å‘åˆ†æ”¯ï¼Œä»developåˆ›å»ºï¼Œå®Œæˆååˆå¹¶å›develop
- **fix/***ï¼šbugä¿®å¤åˆ†æ”¯ï¼Œä»developåˆ›å»ºï¼Œå®Œæˆååˆå¹¶å›develop

#### 4.2.2 ä»£ç æäº¤è§„èŒƒ

ä½¿ç”¨è§„èŒƒåŒ–çš„æäº¤ä¿¡æ¯æ ¼å¼ï¼š

```
<ç±»å‹>: <ç®€çŸ­æè¿°>

[å¯é€‰çš„è¯¦ç»†æè¿°]

[å¯é€‰çš„ç›¸å…³é“¾æ¥æˆ–å¼•ç”¨]
```

æäº¤ç±»å‹åŒ…æ‹¬ï¼š
- **feat**: æ–°å¢åŠŸèƒ½
- **fix**: ä¿®å¤bug
- **docs**: æ–‡æ¡£æ›´æ–°
- **style**: ä»£ç é£æ ¼è°ƒæ•´ï¼ˆä¸å½±å“åŠŸèƒ½ï¼‰
- **refactor**: ä»£ç é‡æ„ï¼ˆä¸æ·»åŠ æ–°åŠŸèƒ½æˆ–ä¿®å¤bugï¼‰
- **perf**: æ€§èƒ½ä¼˜åŒ–
- **test**: æ·»åŠ æˆ–ä¿®æ”¹æµ‹è¯•
- **chore**: æ„å»ºè¿‡ç¨‹æˆ–è¾…åŠ©å·¥å…·å˜åŠ¨

**ç¤ºä¾‹**ï¼š
```
feat: å®ç°ç”¨æˆ·ç§¯åˆ†ç³»ç»Ÿ

- æ·»åŠ ç”¨æˆ·ç§¯åˆ†å­—æ®µ
- å®ç°ç§¯åˆ†æ‰£é™¤é€»è¾‘
- åˆ›å»ºä½¿ç”¨è®°å½•æ¨¡å‹

ç›¸å…³éœ€æ±‚: #123
```

#### 4.2.3 ä»£ç å®¡æŸ¥æµç¨‹

1. å¼€å‘è€…åœ¨featureåˆ†æ”¯å®Œæˆå¼€å‘
2. æ¨é€ä»£ç åˆ°è¿œç¨‹ä»“åº“
3. åˆ›å»ºåˆå¹¶è¯·æ±‚ï¼ˆPull Request/Merge Requestï¼‰
4. æŒ‡å®šè‡³å°‘ä¸€ä½å›¢é˜Ÿæˆå‘˜ä½œä¸ºå®¡æŸ¥è€…
5. å®¡æŸ¥è€…è¿›è¡Œä»£ç å®¡æŸ¥ï¼Œæå‡ºæ”¹è¿›å»ºè®®
6. å¼€å‘è€…æ ¹æ®åé¦ˆä¿®æ”¹ä»£ç 
7. å®¡æŸ¥é€šè¿‡åï¼Œåˆå¹¶åˆ°ç›®æ ‡åˆ†æ”¯
8. å…³é—­ç‰¹æ€§åˆ†æ”¯

**ä»£ç å®¡æŸ¥é‡ç‚¹**ï¼š
- ä»£ç è´¨é‡å’Œå¯è¯»æ€§
- åŠŸèƒ½æ­£ç¡®æ€§å’Œå®Œæ•´æ€§
- æ˜¯å¦ç¬¦åˆä»£ç è§„èŒƒ
- å®‰å…¨æ€§è€ƒè™‘
- æµ‹è¯•è¦†ç›–ç‡

#### 4.2.4 å®ç”¨ Git å‘½ä»¤

**åˆ›å»ºå’Œåˆ‡æ¢åˆ†æ”¯**ï¼š
```bash
# åˆ›å»ºå¹¶åˆ‡æ¢åˆ°æ–°åˆ†æ”¯
git checkout -b feature/new-feature develop

# åˆ‡æ¢å›developåˆ†æ”¯
git checkout develop
```

**æäº¤å’Œæ¨é€**ï¼š
```bash
# æ·»åŠ æ‰€æœ‰ä¿®æ”¹çš„æ–‡ä»¶
git add .

# æäº¤ä»£ç ï¼Œä½¿ç”¨è§„èŒƒçš„æäº¤ä¿¡æ¯
git commit -m "feat: å®ç°æ–°åŠŸèƒ½"

# æ¨é€åˆ°è¿œç¨‹ä»“åº“
git push origin feature/new-feature
```

**æ›´æ–°æœ¬åœ°åˆ†æ”¯**ï¼š
```bash
# è·å–è¿œç¨‹æ›´æ–°
git fetch origin

# æ›´æ–°æœ¬åœ°developåˆ†æ”¯
git checkout develop
git pull origin develop

# å°†developçš„æ›´æ–°åˆå¹¶åˆ°å½“å‰å·¥ä½œåˆ†æ”¯
git checkout feature/my-feature
git merge develop
```

**è§£å†³å†²çª**ï¼š
```bash
# æŸ¥çœ‹å†²çªæ–‡ä»¶
git status

# ç¼–è¾‘å†²çªæ–‡ä»¶ï¼Œè§£å†³å†²çª
# å†²çªéƒ¨åˆ†ä¼šæ ‡è®°ä¸º<<<<<<< HEADå’Œ>>>>>>> branch-name

# è§£å†³å†²çªåï¼Œæ·»åŠ ä¿®æ”¹çš„æ–‡ä»¶
git add conflicted-file.js

# å®Œæˆåˆå¹¶
git commit -m "resolve conflicts"
```

### 4.3 æµ‹è¯•ç­–ç•¥ä¸å®è·µ

#### 4.3.1 æµ‹è¯•ç±»å‹

æˆ‘ä»¬é‡‡ç”¨å¤šå±‚æ¬¡çš„æµ‹è¯•ç­–ç•¥ï¼š

1. **å•å…ƒæµ‹è¯•**ï¼šæµ‹è¯•å•ä¸ªå‡½æ•°æˆ–æ¨¡å—
2. **é›†æˆæµ‹è¯•**ï¼šæµ‹è¯•å¤šä¸ªç»„ä»¶æˆ–æœåŠ¡ä¹‹é—´çš„äº¤äº’
3. **ç«¯åˆ°ç«¯æµ‹è¯•**ï¼šæµ‹è¯•å®Œæ•´çš„ç”¨æˆ·æµç¨‹

#### 4.3.2 å•å…ƒæµ‹è¯•å®è·µ

ä½¿ç”¨Jestä½œä¸ºå•å…ƒæµ‹è¯•æ¡†æ¶ï¼š

**å®‰è£…ä¾èµ–**ï¼š
```bash
npm install --save-dev jest
```

**ç¼–å†™å•å…ƒæµ‹è¯•**ï¼š
```javascript
// lib/creditManager.test.js
const creditManager = require('./creditManager')
const { User } = require('../models')

// æ¨¡æ‹Ÿæ•°æ®åº“æ¨¡å‹
jest.mock('../models', () => ({
  User: {
    findByPk: jest.fn()
  }
}))

describe('ç§¯åˆ†ç®¡ç†æ¨¡å—', () => {
  beforeEach(() => {
    jest.clearAllMocks()
  })

  test('ç®¡ç†å‘˜åº”å…è´¹ä½¿ç”¨æ‰€æœ‰åŠŸèƒ½', async () => {
    // æ¨¡æ‹Ÿç®¡ç†å‘˜ç”¨æˆ·
    User.findByPk.mockResolvedValue({
      id: 1,
      role: 'admin',
      credits: 0,
      freeTextToImageCount: 0
    })

    const result = await creditManager.checkTextToImagePermission(1)
    expect(result.allowed).toBe(true)
    expect(result.isFree).toBe(true)
  })

  test('æ™®é€šç”¨æˆ·åœ¨å…è´¹æ¬¡æ•°å†…å¯å…è´¹ä½¿ç”¨', async () => {
    // æ¨¡æ‹Ÿæ™®é€šç”¨æˆ·ï¼Œæœ‰å…è´¹æ¬¡æ•°
    User.findByPk.mockResolvedValue({
      id: 2,
      role: 'user',
      credits: 0,
      freeTextToImageCount: 3
    })

    const result = await creditManager.checkTextToImagePermission(2)
    expect(result.allowed).toBe(true)
    expect(result.isFree).toBe(true)
  })

  test('ç§¯åˆ†ä¸è¶³æ—¶åº”æ‹’ç»ä½¿ç”¨', async () => {
    // æ¨¡æ‹Ÿæ™®é€šç”¨æˆ·ï¼Œæ— å…è´¹æ¬¡æ•°ä¸”ç§¯åˆ†ä¸è¶³
    User.findByPk.mockResolvedValue({
      id: 3,
      role: 'user',
      credits: 5,
      freeTextToImageCount: 10
    })

    const result = await creditManager.checkTextToImagePermission(3)
    expect(result.allowed).toBe(false)
    expect(result.reason).toBe('ç§¯åˆ†ä¸è¶³')
  })
})
```

**è¿è¡Œæµ‹è¯•**ï¼š
```bash
npm test
```

#### 4.3.3 é›†æˆæµ‹è¯•å®è·µ

ä½¿ç”¨Supertestæµ‹è¯•APIç«¯ç‚¹ï¼š

**å®‰è£…ä¾èµ–**ï¼š
```bash
npm install --save-dev supertest
```

**ç¼–å†™é›†æˆæµ‹è¯•**ï¼š
```javascript
// routes/api.test.js
const request = require('supertest')
const app = require('../server')

describe('APIé›†æˆæµ‹è¯•', () => {
  test('GET /api/users åº”è¿”å›ç”¨æˆ·åˆ—è¡¨', async () => {
    const res = await request(app)
      .get('/api/users')
      .set('Authorization', `Bearer ${validToken}`)
      .expect(200)
    
    expect(Array.isArray(res.body)).toBe(true)
  })

  test('POST /api/auth/login åº”éªŒè¯ç”¨æˆ·å‡­æ®', async () => {
    const res = await request(app)
      .post('/api/auth/login')
      .send({
        email: 'test@example.com',
        password: 'password123'
      })
      .expect(200)
    
    expect(res.body).toHaveProperty('token')
  })
})
```

#### 4.3.4 æµ‹è¯•è¦†ç›–ç‡

è·Ÿè¸ªå’Œæé«˜æµ‹è¯•è¦†ç›–ç‡ï¼š

```bash
# è¿è¡Œæµ‹è¯•å¹¶ç”Ÿæˆè¦†ç›–ç‡æŠ¥å‘Š
npm test -- --coverage
```

**è¦†ç›–ç‡è¦æ±‚**ï¼š
- æ ¸å¿ƒä¸šåŠ¡é€»è¾‘ï¼šâ‰¥90%
- APIç«¯ç‚¹ï¼šâ‰¥80%
- å·¥å…·å‡½æ•°ï¼šâ‰¥85%

### 4.4 æŒç»­é›†æˆ/æŒç»­éƒ¨ç½²

#### 4.4.1 CI/CD æ¦‚å¿µ

**æŒç»­é›†æˆ (CI)**ï¼šå¼€å‘è€…é¢‘ç¹åœ°å°†ä»£ç é›†æˆåˆ°å…±äº«ä»“åº“ï¼Œæ¯æ¬¡é›†æˆåè‡ªåŠ¨è¿è¡Œæµ‹è¯•ï¼Œç¡®ä¿æ–°ä»£ç ä¸ä¼šç ´åç°æœ‰åŠŸèƒ½ã€‚

**æŒç»­éƒ¨ç½² (CD)**ï¼šé€šè¿‡è‡ªåŠ¨åŒ–æµç¨‹ï¼Œå°†é€šè¿‡æµ‹è¯•çš„ä»£ç è‡ªåŠ¨éƒ¨ç½²åˆ°æµ‹è¯•æˆ–ç”Ÿäº§ç¯å¢ƒã€‚

#### 4.4.2 GitHub Actions é…ç½®

ä½¿ç”¨GitHub Actionså®ç°CI/CDï¼š

```yaml
# .github/workflows/ci-cd.yml
name: CI/CD Pipeline

on:
  push:
    branches: [ develop, main ]
  pull_request:
    branches: [ develop ]

jobs:
  test:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: è®¾ç½®Node.js
        uses: actions/setup-node@v3
        with:
          node-version: '20'
          cache: 'npm'
      
      - name: å®‰è£…ä¾èµ–
        run: npm ci
      
      - name: è¿è¡Œæµ‹è¯•
        run: npm test
      
      - name: æ£€æŸ¥ä»£ç é£æ ¼
        run: npm run lint

  build-and-deploy:
    needs: test
    if: github.ref == 'refs/heads/main'
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v3
      
      - name: æ„å»ºDockeré•œåƒ
        run: |
          docker build -t image-ai-processor:${{ github.sha }} .
          docker tag image-ai-processor:${{ github.sha }} image-ai-processor:latest
      
      - name: éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ
        # è¿™é‡Œæ·»åŠ éƒ¨ç½²è„šæœ¬æˆ–ä½¿ç”¨éƒ¨ç½²å·¥å…·
        run: echo "éƒ¨ç½²åˆ°ç”Ÿäº§ç¯å¢ƒ..."
```

#### 4.4.3 Dockeréƒ¨ç½²æµç¨‹

**å¼€å‘ç¯å¢ƒéƒ¨ç½²**ï¼š
```bash
# æ„å»ºå¹¶å¯åŠ¨å¼€å‘ç¯å¢ƒ
docker-compose -f docker-compose.yml -f docker-compose.dev.yml up --build
```

**ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²**ï¼š
```bash
# æ„å»ºå¹¶å¯åŠ¨ç”Ÿäº§ç¯å¢ƒ
docker-compose -f docker-compose.yml -f docker-compose.prod.yml up -d
```

**æœåŠ¡ç›‘æ§**ï¼š
```bash
# æŸ¥çœ‹æœåŠ¡çŠ¶æ€
docker-compose ps

# æŸ¥çœ‹æ—¥å¿—
docker-compose logs -f app

# åœæ­¢æœåŠ¡
docker-compose down
```

#### 4.4.4 æ•°æ®åº“è¿ç§»è‡ªåŠ¨åŒ–

ä½¿ç”¨Sequelize CLIç®¡ç†æ•°æ®åº“è¿ç§»ï¼š

```bash
# å®‰è£…Sequelize CLI
npm install -g sequelize-cli

# åˆ›å»ºæ–°çš„è¿ç§»æ–‡ä»¶
sequelize migration:generate --name add-credit-fields

# è¿è¡Œè¿ç§»
sequelize db:migrate

# å›æ»šè¿ç§»
sequelize db:migrate:undo
```

åœ¨åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨è¿è¡Œè¿ç§»ï¼š

```javascript
// server.js
const express = require('express')
const { Sequelize } = require('./models')
const app = express()

async function startServer() {
  try {
    // è¿è¡Œæ•°æ®åº“è¿ç§»
    await Sequelize.sync({ alter: process.env.NODE_ENV !== 'production' })
    
    // å¯åŠ¨æœåŠ¡å™¨
    const PORT = process.env.PORT || 3000
    app.listen(PORT, () => {
      console.log(`æœåŠ¡å™¨è¿è¡Œåœ¨ç«¯å£ ${PORT}`)
    })
  } catch (error) {
    console.error('å¯åŠ¨å¤±è´¥:', error)
    process.exit(1)
  }
}

startServer()
```

### 4.5 ä»£ç è´¨é‡ä¸å®‰å…¨

#### 4.5.1 ä»£ç è´¨é‡å·¥å…·

ä½¿ç”¨ESLintå’ŒPrettierç¡®ä¿ä»£ç è´¨é‡ï¼š

**å®‰è£…ä¾èµ–**ï¼š
```bash
npm install --save-dev eslint prettier eslint-config-prettier eslint-plugin-prettier
```

**é…ç½®ESLint**ï¼š
```javascript
// .eslintrc.js
module.exports = {
  env: {
    node: true,
    jest: true,
    es2021: true
  },
  extends: ['eslint:recommended', 'prettier'],
  plugins: ['prettier'],
  rules: {
    'prettier/prettier': 'error',
    'no-console': process.env.NODE_ENV === 'production' ? 'error' : 'warn',
    'no-debugger': process.env.NODE_ENV === 'production' ? 'error' : 'warn'
  }
}
```

**é…ç½®Prettier**ï¼š
```json
// .prettierrc
{
  "singleQuote": true,
  "trailingComma": "es5",
  "tabWidth": 2,
  "semi": false
}
```

**ä½¿ç”¨è„šæœ¬**ï¼š
```json
// package.json
{
  "scripts": {
    "lint": "eslint .",
    "format": "prettier --write .",
    "lint:fix": "eslint --fix ."
  }
}
```

#### 4.5.2 å®‰å…¨æœ€ä½³å®è·µ

- **å¯†ç å®‰å…¨**ï¼šä½¿ç”¨bcryptè¿›è¡Œå¯†ç å“ˆå¸Œï¼Œé¿å…å­˜å‚¨æ˜æ–‡å¯†ç 
- **SQLæ³¨å…¥é˜²æŠ¤**ï¼šä½¿ç”¨ORMæˆ–å‚æ•°åŒ–æŸ¥è¯¢
- **è·¨ç«™è„šæœ¬æ”»å‡»(XSS)é˜²æŠ¤**ï¼šå¯¹ç”¨æˆ·è¾“å…¥è¿›è¡ŒéªŒè¯å’Œè½¬ä¹‰
- **è·¨ç«™è¯·æ±‚ä¼ªé€ (CSRF)é˜²æŠ¤**ï¼šä½¿ç”¨CSRFä»¤ç‰Œ
- **æ•æ„Ÿä¿¡æ¯ä¿æŠ¤**ï¼šä¸è®°å½•æˆ–æš´éœ²æ•æ„Ÿä¿¡æ¯ï¼ˆå¯†ç ã€ä»¤ç‰Œç­‰ï¼‰
- **ä¾èµ–æ£€æŸ¥**ï¼šå®šæœŸæ›´æ–°ä¾èµ–ï¼Œé¿å…å·²çŸ¥æ¼æ´

**å®‰è£…ä¾èµ–æ£€æŸ¥å·¥å…·**ï¼š
```bash
npm install --save-dev npm audit

# è¿è¡Œå®‰å…¨æ£€æŸ¥
npm audit

# è‡ªåŠ¨ä¿®å¤å¯ä¿®å¤çš„æ¼æ´
npm audit fix
```

## 5. å­¦ä¹ èµ„æºä¸æ‰©å±•é˜…è¯»

ä½œä¸ºå¤§äºŒå­¦ç”Ÿï¼Œå»ºç«‹æ‰å®çš„è½¯ä»¶å·¥ç¨‹çŸ¥è¯†ä½“ç³»å¯¹æœªæ¥çš„å­¦ä¹ å’ŒèŒä¸šå‘å±•è‡³å…³é‡è¦ã€‚ä»¥ä¸‹æ˜¯ç²¾å¿ƒæŒ‘é€‰çš„å­¦ä¹ èµ„æºï¼Œæ¶µç›–äº†é¡¹ç›®é‡æ„ä¸­æ¶‰åŠçš„å„ä¸ªæ–¹é¢ï¼Œå¸®åŠ©ä½ ç³»ç»Ÿæ€§åœ°æå‡è½¯ä»¶å·¥ç¨‹å®è·µèƒ½åŠ›ã€‚

### 5.1 è½¯ä»¶å·¥ç¨‹åŸºç¡€èµ„æº

#### 5.1.1 ç»å…¸ä¹¦ç±

1. **ã€Šäººæœˆç¥è¯ã€‹** - Frederick P. Brooks Jr.
   - è½¯ä»¶é¡¹ç›®ç®¡ç†çš„ç»å…¸ä¹‹ä½œï¼Œæ­ç¤ºäº†è½¯ä»¶å·¥ç¨‹ä¸­çš„æ ¸å¿ƒæŒ‘æˆ˜å’Œç»éªŒæ•™è®­
   - é€‚åˆç†è§£å¤§å‹è½¯ä»¶é¡¹ç›®ä¸­çš„ç»„ç»‡ç®¡ç†ã€è¿›åº¦ä¼°ç®—ç­‰å…³é”®é—®é¢˜

2. **ã€Šä»£ç æ•´æ´ä¹‹é“ã€‹** - Robert C. Martin
   - è¯¦ç»†é˜è¿°äº†ç¼–å†™é«˜è´¨é‡ä»£ç çš„åŸåˆ™å’Œå®è·µ
   - åŒ…å«ä¸°å¯Œçš„ä»£ç ç¤ºä¾‹ï¼Œå¸®åŠ©ä½ åŸ¹å…»è‰¯å¥½çš„ç¼–ç ä¹ æƒ¯

3. **ã€Šè®¾è®¡æ¨¡å¼ï¼šå¯å¤ç”¨é¢å‘å¯¹è±¡è½¯ä»¶çš„åŸºç¡€ã€‹** - Erich Gammaç­‰
   - ä»‹ç»äº†23ç§ç»å…¸è®¾è®¡æ¨¡å¼ï¼Œæ˜¯è½¯ä»¶è®¾è®¡çš„å¿…è¯»ä¹‹ä½œ
   - å¯¹äºç†è§£é¡¹ç›®é‡æ„ä¸­çš„æ¶æ„ä¼˜åŒ–å’Œä»£ç ç»„ç»‡æœ‰é‡è¦å‚è€ƒä»·å€¼

4. **ã€Šæµ‹è¯•é©±åŠ¨å¼€å‘ã€‹** - Kent Beck
   - è¯¦ç»†è®²è§£æµ‹è¯•é©±åŠ¨å¼€å‘(TDD)çš„ç†å¿µå’Œå®è·µæ–¹æ³•
   - å¸®åŠ©ä½ å»ºç«‹"å…ˆæµ‹è¯•ï¼Œåç¼–ç "çš„å¼€å‘ä¹ æƒ¯

#### 5.1.2 åœ¨çº¿è¯¾ç¨‹

1. **Coursera: Software Engineering** (University of Pennsylvania)
   - å…¨é¢ä»‹ç»è½¯ä»¶å·¥ç¨‹çš„æ ¸å¿ƒæ¦‚å¿µã€æ–¹æ³•å’Œå·¥å…·
   - åŒ…å«å®é™…é¡¹ç›®æ¡ˆä¾‹ï¼Œå¸®åŠ©ä½ ç†è§£è½¯ä»¶å·¥ç¨‹çš„å®é™…åº”ç”¨

2. **edX: Web Application Development with JavaScript** (MIT)
   - æ·±å…¥è®²è§£JavaScriptå…¨æ ˆå¼€å‘æŠ€æœ¯
   - æ¶µç›–å‰ç«¯å’Œåç«¯å¼€å‘ï¼Œä¸æˆ‘ä»¬çš„é¡¹ç›®æŠ€æœ¯æ ˆé«˜åº¦ç›¸å…³

3. **Udemy: Docker Mastery: The Complete Toolset**
   - ç³»ç»Ÿå­¦ä¹ Dockerå®¹å™¨æŠ€æœ¯
   - åŒ…å«ä¸°å¯Œçš„å®æˆ˜ç»ƒä¹ ï¼Œå¸®åŠ©ä½ æŒæ¡å®¹å™¨åŒ–éƒ¨ç½²æŠ€èƒ½

4. **ä¸­å›½å¤§å­¦MOOC: è½¯ä»¶å·¥ç¨‹** (æ¸…åå¤§å­¦/åŒ—äº¬å¤§å­¦)
   - é€‚åˆä¸­æ–‡è¯»è€…çš„è½¯ä»¶å·¥ç¨‹è¯¾ç¨‹
   - ç³»ç»Ÿè®²è§£è½¯ä»¶å·¥ç¨‹çš„åŸºæœ¬ç†è®ºå’Œå®è·µæ–¹æ³•

### 5.2 Webå¼€å‘æŠ€æœ¯å­¦ä¹ 

#### 5.2.1 å‰ç«¯å¼€å‘èµ„æº

1. **MDN Web Docs**
   - ç½‘å€ï¼š[https://developer.mozilla.org/zh-CN/](https://developer.mozilla.org/zh-CN/)
   - WebæŠ€æœ¯çš„æƒå¨å‚è€ƒæ–‡æ¡£ï¼Œæ¶µç›–HTMLã€CSSã€JavaScriptç­‰å‰ç«¯æŠ€æœ¯

2. **é˜®ä¸€å³°çš„ç½‘ç»œæ—¥å¿—**
   - ç½‘å€ï¼š[http://www.ruanyifeng.com/blog/](http://www.ruanyifeng.com/blog/)
   - æ·±å…¥æµ…å‡ºçš„æŠ€æœ¯æ–‡ç« ï¼Œé€‚åˆåˆå­¦è€…ç†è§£å¤æ‚æ¦‚å¿µ

3. **ç°ä»£JavaScriptæ•™ç¨‹**
   - ç½‘å€ï¼š[https://zh.javascript.info/](https://zh.javascript.info/)
   - å…¨é¢ç³»ç»Ÿçš„JavaScriptå­¦ä¹ èµ„æºï¼Œä»åŸºç¡€åˆ°é«˜çº§

4. **Reactå®˜æ–¹æ–‡æ¡£**
   - ç½‘å€ï¼š[https://react.dev/](https://react.dev/)
   - Reactæ¡†æ¶çš„å®˜æ–¹æŒ‡å—å’Œæ•™ç¨‹

#### 5.2.2 åç«¯å¼€å‘èµ„æº

1. **Node.jså®˜æ–¹æ–‡æ¡£**
   - ç½‘å€ï¼š[https://nodejs.org/zh-cn/docs/](https://nodejs.org/zh-cn/docs/)
   - Node.jsçš„å®˜æ–¹æ–‡æ¡£å’Œæ•™ç¨‹

2. **Express.jså®˜æ–¹æ–‡æ¡£**
   - ç½‘å€ï¼š[https://expressjs.com/zh-cn/](https://expressjs.com/zh-cn/)
   - Expressæ¡†æ¶çš„è¯¦ç»†ä½¿ç”¨æŒ‡å—

3. **SQLæ•™ç¨‹**
   - ç½‘å€ï¼š[https://www.w3schools.com/sql/](https://www.w3schools.com/sql/)
   - ç³»ç»Ÿå­¦ä¹ SQLè¯­è¨€çš„åŸºç¡€æ•™ç¨‹

4. **Sequelizeå®˜æ–¹æ–‡æ¡£**
   - ç½‘å€ï¼š[https://sequelize.org/](https://sequelize.org/)
   - Node.js ORMæ¡†æ¶çš„ä½¿ç”¨æŒ‡å—

### 5.3 å®¹å™¨åŒ–ä¸éƒ¨ç½²æŠ€æœ¯

1. **Dockerå®˜æ–¹æ–‡æ¡£**
   - ç½‘å€ï¼š[https://docs.docker.com/](https://docs.docker.com/)
   - Dockerå®¹å™¨æŠ€æœ¯çš„å®˜æ–¹æ–‡æ¡£å’Œæ•™ç¨‹

2. **Dockerä»å…¥é—¨åˆ°å®è·µ**
   - ç½‘å€ï¼š[https://yeasy.gitbook.io/docker_practice/](https://yeasy.gitbook.io/docker_practice/)
   - é€‚åˆä¸­æ–‡è¯»è€…çš„Dockerå®è·µæŒ‡å—

3. **Docker Composeå®˜æ–¹æ–‡æ¡£**
   - ç½‘å€ï¼š[https://docs.docker.com/compose/](https://docs.docker.com/compose/)
   - Docker Composeå·¥å…·çš„è¯¦ç»†ä½¿ç”¨è¯´æ˜

4. **Kuberneteså®˜æ–¹æ–‡æ¡£**
   - ç½‘å€ï¼š[https://kubernetes.io/zh/docs/home/](https://kubernetes.io/zh/docs/home/)
   - å®¹å™¨ç¼–æ’å¹³å°Kubernetesçš„å…¥é—¨æŒ‡å—ï¼ˆé€‚åˆè¿›é˜¶å­¦ä¹ ï¼‰

### 5.4 ç‰ˆæœ¬æ§åˆ¶ä¸åä½œå·¥å…·

1. **Gitå®˜æ–¹æ–‡æ¡£**
   - ç½‘å€ï¼š[https://git-scm.com/doc](https://git-scm.com/doc)
   - Gitç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿçš„å®Œæ•´å‚è€ƒæ–‡æ¡£

2. **Gitæ•™ç¨‹ - å»–é›ªå³°çš„å®˜æ–¹ç½‘ç«™**
   - ç½‘å€ï¼š[https://www.liaoxuefeng.com/wiki/896043488029600](https://www.liaoxuefeng.com/wiki/896043488029600)
   - é€‚åˆä¸­æ–‡è¯»è€…çš„Gitå…¥é—¨æ•™ç¨‹

3. **GitHub Learning Lab**
   - ç½‘å€ï¼š[https://lab.github.com/](https://lab.github.com/)
   - äº¤äº’å¼çš„GitHubä½¿ç”¨æ•™ç¨‹

4. **Pro Git**
   - ç½‘å€ï¼š[https://git-scm.com/book/zh/v2](https://git-scm.com/book/zh/v2)
   - å…è´¹çš„Gitç”µå­ä¹¦ï¼Œæ·±å…¥è®²è§£GitåŸç†å’Œé«˜çº§ç”¨æ³•

### 5.5 æµ‹è¯•ä¸è´¨é‡ä¿è¯

1. **Jestå®˜æ–¹æ–‡æ¡£**
   - ç½‘å€ï¼š[https://jestjs.io/zh-Hans/docs/getting-started](https://jestjs.io/zh-Hans/docs/getting-started)
   - JavaScriptæµ‹è¯•æ¡†æ¶çš„ä½¿ç”¨æŒ‡å—

2. **æµ‹è¯•é©±åŠ¨å¼€å‘å®æˆ˜**
   - ç½‘å€ï¼š[https://tdd.works/](https://tdd.works/)
   - TDDå®è·µæ¡ˆä¾‹å’Œæœ€ä½³å®è·µ

3. **ESLintå®˜æ–¹æ–‡æ¡£**
   - ç½‘å€ï¼š[https://eslint.org/docs/latest/](https://eslint.org/docs/latest/)
   - JavaScriptä»£ç æ£€æŸ¥å·¥å…·çš„é…ç½®å’Œä½¿ç”¨

4. **Prettierå®˜æ–¹æ–‡æ¡£**
   - ç½‘å€ï¼š[https://prettier.io/docs/en/](https://prettier.io/docs/en/)
   - ä»£ç æ ¼å¼åŒ–å·¥å…·çš„ä½¿ç”¨è¯´æ˜

### 5.6 å¼€å‘å·¥å…·ä¸ç¼–è¾‘å™¨

1. **VS Codeå®˜æ–¹æ–‡æ¡£**
   - ç½‘å€ï¼š[https://code.visualstudio.com/docs](https://code.visualstudio.com/docs)
   - æ¨èçš„ä»£ç ç¼–è¾‘å™¨è¯¦ç»†æŒ‡å—

2. **VS Codeæ’ä»¶æ¨è**
   - ESLintï¼šä»£ç è´¨é‡æ£€æŸ¥
   - Prettierï¼šä»£ç æ ¼å¼åŒ–
   - GitLensï¼šGitå¢å¼ºåŠŸèƒ½
   - REST Clientï¼šAPIæµ‹è¯•
   - Dockerï¼šå®¹å™¨ç®¡ç†

3. **Postmanå®˜æ–¹æ–‡æ¡£**
   - ç½‘å€ï¼š[https://learning.postman.com/](https://learning.postman.com/)
   - APIæµ‹è¯•å·¥å…·çš„ä½¿ç”¨æ•™ç¨‹

4. **æ•°æ®åº“å¯è§†åŒ–å·¥å…·**
   - DBeaverï¼š[https://dbeaver.io/](https://dbeaver.io/)
   - pgAdminï¼š[https://www.pgadmin.org/](https://www.pgadmin.org/)

### 5.7 æŠ€æœ¯ç¤¾åŒºä¸è®ºå›

1. **GitHub**
   - ç½‘å€ï¼š[https://github.com/](https://github.com/)
   - æœ€å¤§çš„å¼€æºä»£ç æ‰˜ç®¡å¹³å°ï¼Œå‚ä¸å¼€æºé¡¹ç›®çš„ç»ä½³åœºæ‰€

2. **Stack Overflow**
   - ç½‘å€ï¼š[https://stackoverflow.com/](https://stackoverflow.com/)
   - ç¨‹åºå‘˜é—®ç­”ç¤¾åŒºï¼Œè§£å†³æŠ€æœ¯é—®é¢˜çš„é¦–é€‰å¹³å°

3. **æ˜é‡‘**
   - ç½‘å€ï¼š[https://juejin.cn/](https://juejin.cn/)
   - ä¸­æ–‡å¼€å‘è€…ç¤¾åŒºï¼Œåˆ†äº«æŠ€æœ¯æ–‡ç« å’Œç»éªŒ

4. **SegmentFault**
   - ç½‘å€ï¼š[https://segmentfault.com/](https://segmentfault.com/)
   - ä¸­æ–‡æŠ€æœ¯é—®ç­”ç¤¾åŒº

5. **æŠ€æœ¯ä¼šè®®ä¸è®²åº§**
   - JSConfä¸­å›½
   - QConå…¨çƒè½¯ä»¶å¼€å‘å¤§ä¼š
   - å„é«˜æ ¡ä¸¾åŠçš„æŠ€æœ¯è®²åº§å’Œé»‘å®¢æ¾æ´»åŠ¨

### 5.8 æ¨èå­¦ä¹ è·¯å¾„

#### 5.8.1 å¤§äºŒå­¦ç”Ÿçš„å…¥é—¨å­¦ä¹ è·¯å¾„

1. **ç¬¬ä¸€é˜¶æ®µï¼šWebå¼€å‘åŸºç¡€ï¼ˆ1-2ä¸ªæœˆï¼‰**
   - HTML/CSSåŸºç¡€
   - JavaScriptæ ¸å¿ƒæ¦‚å¿µ
   - ç®€å•çš„å‰ç«¯é¡µé¢å¼€å‘

2. **ç¬¬äºŒé˜¶æ®µï¼šåç«¯å¼€å‘å…¥é—¨ï¼ˆ2-3ä¸ªæœˆï¼‰**
   - Node.jsåŸºç¡€
   - Expressæ¡†æ¶
   - RESTful APIè®¾è®¡
   - æ•°æ®åº“åŸºç¡€ä¸SQL

3. **ç¬¬ä¸‰é˜¶æ®µï¼šå…¨æ ˆå¼€å‘å®è·µï¼ˆ3-4ä¸ªæœˆï¼‰**
   - å‰ç«¯æ¡†æ¶ï¼ˆReact/Vueï¼‰
   - åç«¯ä¸æ•°æ®åº“äº¤äº’
   - ç”¨æˆ·è®¤è¯ä¸æˆæƒ
   - å®Œæ•´é¡¹ç›®å¼€å‘

4. **ç¬¬å››é˜¶æ®µï¼šè½¯ä»¶å·¥ç¨‹å®è·µï¼ˆ2-3ä¸ªæœˆï¼‰**
   - Gitç‰ˆæœ¬æ§åˆ¶
   - æµ‹è¯•é©±åŠ¨å¼€å‘
   - å®¹å™¨åŒ–éƒ¨ç½²
   - CI/CDæµç¨‹

#### 5.8.2 è¿›é˜¶å­¦ä¹ å»ºè®®

1. **æ·±å…¥ç ”ç©¶ç‰¹å®šæŠ€æœ¯æ ˆ**
   - é€‰æ‹©1-2ä¸ªæ„Ÿå…´è¶£çš„æŠ€æœ¯æ–¹å‘æ·±å…¥å­¦ä¹ 
   - å‚ä¸å¼€æºé¡¹ç›®æˆ–å¼€å‘ä¸ªäººé¡¹ç›®

2. **å­¦ä¹ ç³»ç»Ÿè®¾è®¡**
   - å¤§å‹ç³»ç»Ÿæ¶æ„è®¾è®¡
   - å¾®æœåŠ¡æ¶æ„
   - æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

3. **æŒæ¡DevOpsæŠ€èƒ½**
   - è‡ªåŠ¨åŒ–éƒ¨ç½²
   - ç›‘æ§ä¸æ—¥å¿—ç®¡ç†
   - å®¹å™¨ç¼–æ’

4. **åŸ¹å…»è½¯æŠ€èƒ½**
   - å›¢é˜Ÿåä½œèƒ½åŠ›
   - æŠ€æœ¯æ–‡æ¡£å†™ä½œ
   - æ¼”è®²ä¸æ²Ÿé€šæŠ€å·§

### 5.9 å¦‚ä½•é«˜æ•ˆå­¦ä¹ è½¯ä»¶å·¥ç¨‹

1. **ç†è®ºä¸å®è·µç»“åˆ**
   - å­¦ä¹ ç†è®ºçŸ¥è¯†çš„åŒæ—¶ï¼Œå¿…é¡»è¿›è¡Œå®é™…ç¼–ç¨‹ç»ƒä¹ 
   - ä»å°å‹é¡¹ç›®å¼€å§‹ï¼Œé€æ­¥è¿‡æ¸¡åˆ°æ›´å¤æ‚çš„é¡¹ç›®

2. **é‡‡ç”¨è´¹æ›¼å­¦ä¹ æ³•**
   - å°è¯•å‘ä»–äººè§£é‡Šä½ å­¦åˆ°çš„æ¦‚å¿µ
   - æ•™æ˜¯æœ€å¥½çš„å­¦

3. **æŒç»­ç¼–ç ä¹ æƒ¯**
   - ä¿æŒæ¯å¤©ç¼–ç¨‹çš„ä¹ æƒ¯
   - ä½¿ç”¨GitHubè®°å½•å­¦ä¹ è¿‡ç¨‹

4. **å‚ä¸ç¤¾åŒºäº¤æµ**
   - åŠ å…¥æŠ€æœ¯ç¤¾åŒºï¼Œæé—®å’Œå›ç­”é—®é¢˜
   - å…³æ³¨è¡Œä¸šåŠ¨æ€å’Œæœ€æ–°æŠ€æœ¯

5. **å®šæœŸå›é¡¾ä¸æ€»ç»“**
   - å®šæœŸå›é¡¾æ‰€å­¦çŸ¥è¯†
   - æ€»ç»“é¡¹ç›®ç»éªŒå’Œæ•™è®­

é€šè¿‡ç³»ç»Ÿå­¦ä¹ å’Œå®è·µè¿™äº›èµ„æºï¼Œä½ å°†èƒ½å¤Ÿå…¨é¢ç†è§£ç°ä»£è½¯ä»¶å·¥ç¨‹çš„ç†å¿µå’Œå®è·µï¼Œä¸ºæœªæ¥çš„å­¦ä¹ å’ŒèŒä¸šå‘å±•æ‰“ä¸‹åšå®çš„åŸºç¡€ã€‚è®°ä½ï¼Œè½¯ä»¶å·¥ç¨‹æ˜¯ä¸€ä¸ªä¸æ–­å­¦ä¹ å’Œæˆé•¿çš„é¢†åŸŸï¼Œä¿æŒå¥½å¥‡å¿ƒå’Œå­¦ä¹ çƒ­æƒ…æ˜¯æˆåŠŸçš„å…³é”®ã€‚

## é™„å½•: é¡¹ç›®èµ„æº

- [é¡¹ç›®æºä»£ç ](https://github.com/yourusername/image-ai-processor)
- [API æ–‡æ¡£](http://localhost:3000/api-docs)
- [å¼€å‘è€…æŒ‡å—](http://localhost:3000/developer-guide)
